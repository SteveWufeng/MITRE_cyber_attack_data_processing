ID,name,description,url,created,last modified,version,contributors,tactics,detection,platforms,tactic type,MTC ID,relationship citations
T1626,Abuse Elevation Control Mechanism,Adversaries may circumvent mechanisms designed to control elevated privileges to gain higher-level permissions. Most modern systems contain native elevation control mechanisms that are intended to limit privileges that a user can gain on a machine. Authorization has to be granted to specific users in order to perform tasks that are designated as higher risk. An adversary can use several methods to take advantage of built-in control mechanisms in order to escalate privileges on a system. ,https://attack.mitre.org/techniques/T1626,01 April 2022,05 April 2022,1.0,,Privilege Escalation,"When an application requests administrator permission, users are presented with a popup and the option to grant or deny the request. Application vetting services can detect when an application requests administrator permission. Extra scrutiny could be applied to applications that do",Android,Post-Adversary Device Access,APP-22,","
T1517,Access Notifications,"Adversaries may collect data within notifications sent by the operating system or other applications. Notifications may contain sensitive data such as one-time authentication codes sent over SMS, email, or other mediums. In the case of Credential Access, adversaries may attempt to intercept one-time code sent to the device. Adversaries can also dismiss notifications to prevent the user from noticing that the notification has arrived and can trigger action buttons contained within notifications.(Citation: ESET 2FA Bypass) ",https://attack.mitre.org/techniques/T1517,15 September 2019,11 April 2022,1.1,,"Collection, Credential Access",Application vetting services can look for applications requesting the `BIND_NOTIFICATION_LISTENER_SERVICE` permission in a service declaration. Users can also inspect and modify the list of applications that have notification access through the device settings (e.g. Apps & notification -> Special app access -> Notification access). ,Android,Post-Adversary Device Access,,"(Citation: Check Point-Joker),(Citation: TrendMicro Coronavirus Updates),(Citation: Bitdefender Mandrake),(Citation: Talos-WolfRAT),(Citation: Android Notification Listeners)"
T1640,Account Access Removal,"Adversaries may interrupt availability of system and network resources by inhibiting access to accounts utilized by legitimate users. Accounts may be deleted, locked, or manipulated (ex: credentials changed) to remove access to accounts. ",https://attack.mitre.org/techniques/T1640,06 April 2022,06 April 2022,1.0,,Impact,Application vetting services could closely scrutinize applications that request Device Administrator permissions.,Android,Post-Adversary Device Access,,"(Citation: Lookout-Monokle),"
T1638,Adversary-in-the-Middle,"Adversaries may attempt to position themselves between two or more networked devices to support follow-on behaviors such as [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1565/002) or [Endpoint Denial of Service](https://attack.mitre.org/techniques/T1642).  

 

[Adversary-in-the-Middle](https://attack.mitre.org/techniques/T1638) can be achieved through several mechanisms, such as a malicious application registering itself as a VPN client. By doing this, the adversary can effectively redirect device traffic to wherever they want. However, registering as a VPN client requires user consent on both Android and iOS. Additionally, on iOS, the application requires a special entitlement that must be granted by Apple. Alternatively, if an application is able to escalate privileges, it can potentially utilize those privileges to gain access to network traffic.  

 

Outside of a mobile device, adversaries may be able to capture traffic by employing a rogue base station or Wi-Fi access point. These devices will allow adversaries to capture network traffic after it has left the device, while it is flowing to its destination. On a local network, enterprise techniques could be used, such as DNS redirection or DNS poisoning.  

 

If applications properly encrypt their network traffic, sensitive data may not be accessible an adversary, depending on the point of capture. ",https://attack.mitre.org/techniques/T1638,05 April 2022,11 April 2022,2.0,,Collection,"Application vetting services should look for applications that request VPN access. These applications should be heavily scrutinized since VPN functionality is not very common. Mobile security products can potentially detect rogue Wi-Fi access points if the adversary is attempting to decrypt traffic using an untrusted SSL certificate. 

 

On both Android and iOS, users must grant consent to an application to act as a VPN. Both platforms also provide visual context to the user in the top status bar when a VPN connection is active. Users can see registered VPN services in the device settings. ","Android, iOS",Post-Adversary Device Access,CEL-3,"(Citation: Skycure-Profiles),(Citation: Xiao-KeyRaider),"
T1437,Application Layer Protocol,"Adversaries may communicate using application layer protocols to avoid detection/network filtering by blending in with existing traffic. Commands to the mobile device, and often the results of those commands, will be embedded within the protocol traffic between the mobile device and server. 

Adversaries may utilize many different protocols, including those used for web browsing, transferring files, electronic mail, or DNS.",https://attack.mitre.org/techniques/T1437,25 October 2017,19 April 2022,1.2,,Command and Control,Abuse of standard application protocols can be difficult to detect as many legitimate mobile applications leverage such protocols for language-specific APIs. Enterprises may be better served focusing on detection at other stages of adversarial behavior.,"Android, iOS",Post-Adversary Device Access,APP-29,"(Citation: Lookout Uyghur Campaign),"
T1532,Archive Collected Data,"Adversaries may compress and/or encrypt data that is collected prior to exfiltration. Compressing data can help to obfuscate its contents and minimize use of network resources. Encryption can be used to hide information that is being exfiltrated from detection or make exfiltration less conspicuous upon inspection by a defender. 

 

Both compression and encryption are done prior to exfiltration, and can be performed using a utility, programming library, or custom algorithm.  ",https://attack.mitre.org/techniques/T1532,10 October 2019,01 April 2022,2.0,,Collection,Many encryption mechanisms are built into standard application-accessible APIs and are therefore undetectable to the end user.,"Android, iOS",Post-Adversary Device Access,,"(Citation: Securelist Asacub),(Citation: Lookout FrozenCell),(Citation: SWB Exodus March 2019),(Citation: Symantec GoldenCup),(Citation: Lookout Desert Scorpion),(Citation: Cofense Anubis),(Citation: Google Triada June 2019),(Citation: Trend Micro Bouncing Golf 2019),"
T1521.002,Asymmetric Cryptography,"Adversaries may employ a known asymmetric encryption algorithm to conceal command and control traffic, rather than relying on any inherent protections provided by a communication protocol. Asymmetric cryptography, also known as public key cryptography, uses a keypair per party: one public that can be freely distributed, and one private that should not be distributed. Due to how asymmetric algorithms work, the sender encrypts data with the receiver’s public key and the receiver decrypts the data with their private key. This ensures that only the intended recipient can read the encrypted data. Common public key encryption algorithms include RSA, ElGamal, and ECDSA.

For efficiency, many protocols (including SSL/TLS) use symmetric cryptography once a connection is established, but use asymmetric cryptography to establish or transmit a key. As such, these protocols are classified as [Asymmetric Cryptography](https://attack.mitre.org/techniques/T1521/002).",https://attack.mitre.org/techniques/T1521/002,05 April 2022,05 April 2022,1.0,,Command and Control,"Since data encryption is a common practice in many legitimate applications and uses standard programming language-specific APIs, encrypting data for command and control communication is regarded as undetectable to the user.","Android, iOS",Post-Adversary Device Access,,"(Citation: Lookout Uyghur Campaign),(Citation: Lookout eSurv),(Citation: CYBERWARCON CHEMISTGAMES),"
T1429,Audio Capture,"Adversaries may capture audio to collect information by leveraging standard operating system APIs of a mobile device. Examples of audio information adversaries may target include user conversations, surroundings, phone calls, or other sensitive information. 

 

Android and iOS, by default, require that applications request device microphone access from the user.  

 

On Android devices, applications must hold the `RECORD_AUDIO` permission to access the microphone or the `CAPTURE_AUDIO_OUTPUT` permission to access audio output. Because Android does not allow third-party applications to hold the `CAPTURE_AUDIO_OUTPUT` permission by default, only privileged applications, such as those distributed by Google or the device vendor, can access audio output.(Citation: Android Permissions) However, adversaries may be able to gain this access after successfully elevating their privileges. With the `CAPTURE_AUDIO_OUTPUT` permission, adversaries may pass the `MediaRecorder.AudioSource.VOICE_CALL` constant to `MediaRecorder.setAudioOutput`, allowing capture of both voice call uplink and downlink.(Citation: Manifest.permission) 

 

On iOS devices, applications must include the `NSMicrophoneUsageDescription` key in their `Info.plist` file to access the microphone.(Citation: Requesting Auth-Media Capture)",https://attack.mitre.org/techniques/T1429,25 October 2017,29 April 2022,3.0,,Collection,"In iOS 14 and up, an orange dot (or orange square if the Differentiate Without Color setting is enabled) appears in the status bar when the microphone is being used by an application. However, there have been demonstrations indicating it may still be possible to access the microphone in the background without triggering this visual indicator by abusing features that natively access the microphone or camera but do not trigger the visual indicators.(Citation: iOS Mic Spyware)


In Android 12 and up, a green dot appears in the status bar when the microphone is being used by an application.(Citation: Android Privacy Indicators)
 

Android applications using the `RECORD_AUDIO` permission and iOS applications using `RequestRecordPermission` should be carefully reviewed and monitored. If the `CAPTURE_AUDIO_OUTPUT` permission is found in a third-party Android application, the application should be heavily scrutinized. 

 

In both Android (6.0 and up) and iOS, users can review which applications have the permission to access the microphone through the device settings screen and revoke permissions as necessary. ","Android, iOS",Post-Adversary Device Access,APP-19,"(Citation: Talos-WolfRAT),(Citation: Cofense Anubis),(Citation: TrendMicro-RCSAndroid),(Citation: SecureList BusyGasper),(Citation: PaloAlto-SpyDealer),(Citation: Zscaler-SpyNote),(Citation: Lookout ViperRAT),(Citation: Lookout-EnterpriseApps),(Citation: Zscaler TikTok Spyware),(Citation: SecureList - ViceLeaker 2019),(Citation: Lookout Uyghur Campaign),(Citation: Kaspersky-Skygofree),(Citation: Zscaler-SuperMarioRun),(Citation: Lookout-Monokle),(Citation: Wandera-RedDrop),(Citation: Lookout-Dendroid),(Citation: Lookout eSurv),(Citation: CyberMerchants-FlexiSpy),(Citation: TrendMicro Coronavirus Updates),(Citation: SWB Exodus March 2019),(Citation: Lookout Desert Scorpion),(Citation: Lookout-PegasusAndroid),(Citation: Bitdefender - Triout 2018),(Citation: Lookout-Pegasus),(Citation: TrendMicro-XLoader),(Citation: Lookout-StealthMango),(Citation: Lookout FrozenCell),(Citation: Symantec GoldenCup),(Citation: Palo Alto HenBox),(Citation: Lookout Dark Caracal Jan 2018),(Citation: BlackBerry Bahamut),(Citation: Trend Micro Bouncing Golf 2019),(Citation: Android Capture Sensor 2019)"
T1481.002,Bidirectional Communication,"Adversaries may use an existing, legitimate external Web service channel as a means for sending commands to and receiving output from a compromised system. Compromised systems may leverage popular websites and social media to host command and control (C2) instructions. Those infected systems can then send the output from those commands back over that Web service channel. The return traffic may occur in a variety of ways, depending on the Web service being utilized. For example, the return traffic may take the form of the compromised system posting a comment on a forum, issuing a pull request to development project, updating a document hosted on a Web service, or by sending a Tweet. 

 

Popular websites and social media, acting as a mechanism for C2, may give a significant amount of cover. This is due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection. ",https://attack.mitre.org/techniques/T1481/002,06 April 2022,06 April 2022,1.0,,Command and Control,"Application vetting services may provide a list of connections made or received by an application, or a list of domains contacted by the application.","Android, iOS",Post-Adversary Device Access,,"(Citation: SecureList BusyGasper),(Citation: Bitdefender Mandrake),(Citation: WhiteOps TERRACOTTA),"
T1398,Boot or Logon Initialization Scripts,Adversaries may use scripts automatically executed at boot or logon initialization to establish persistence. Initialization scripts are part of the underlying operating system and are not accessible to the user unless the device has been rooted or jailbroken. ,https://attack.mitre.org/techniques/T1398,25 October 2017,11 April 2022,2.0,,Persistence,"On Android, Verified Boot can detect unauthorized modifications to the system partition.(Citation: Android-VerifiedBoot) Android's SafetyNet API provides remote attestation capabilities, which could potentially be used to identify and respond to compromise devices. Samsung Knox provides a similar remote attestation capability on supported Samsung devices. ","Android, iOS",Post-Adversary Device Access,APP-26,"(Citation: HackerNews-OldBoot),"
T1624.001,Broadcast Receivers,"Adversaries may establish persistence using system mechanisms that trigger execution based on specific events. Mobile operating systems have means to subscribe to events such as receiving an SMS message, device boot completion, or other device activities. 

An intent is a message passed between Android applications or system components. Applications can register to receive broadcast intents at runtime, which are system-wide intents delivered to each app when certain events happen on the device, such as network changes or the user unlocking the screen. Malicious applications can then trigger certain actions within the app based on which broadcast intent was received. 

In addition to Android system intents, malicious applications can register for intents broadcasted by other applications. This allows the malware to respond based on actions in other applications. This behavior typically indicates a more intimate knowledge, or potentially the targeting of specific devices, users, or applications. 

In Android 8 (API level 26), broadcast intent behavior was changed, limiting the implicit intents that applications can register for in the manifest. In most cases, applications that register through the manifest will no longer receive the broadcasts. Now, applications must register context-specific broadcast receivers while the user is actively using the app.(Citation: Android Changes to System Broadcasts) ",https://attack.mitre.org/techniques/T1624/001,30 March 2022,19 April 2022,1.0,"Alex Hinchliffe, Palo Alto Networks",Persistence,Application vetting services can detect which broadcast intents an application registers for and which permissions it requests. ,Android,Post-Adversary Device Access,,"(Citation: WhiteOps TERRACOTTA),(Citation: FortiGuard-FlexiSpy),(Citation: Microsoft MalLockerB),(Citation: Talos GPlayed),(Citation: PaloAlto-SpyDealer),(Citation: Palo Alto HenBox),(Citation: SecurityIntelligence TrickMo),(Citation: Threat Fabric Exobot),(Citation: WeLiveSecurity AdDisplayAshas),(Citation: Cybereason EventBot),(Citation: ESET DEFENSOR ID),(Citation: Lookout-PegasusAndroid),(Citation: CheckPoint SimBad 2019),(Citation: Zscaler-SpyNote),(Citation: Zscaler TikTok Spyware),(Citation: Cybereason FakeSpy),(Citation: Trend Micro Bouncing Golf 2019),(Citation: Android Changes to System Broadcasts)"
T1636.001,Calendar Entries,"Adversaries may utilize standard operating system APIs to gather calendar entry data. On Android, this can be accomplished using the Calendar Content Provider. On iOS, this can be accomplished using the `EventKit` framework. 

 

If the device has been jailbroken or rooted, an adversary may be able to access [Calendar Entries](https://attack.mitre.org/techniques/T1636/001) without the user’s knowledge or approval. ",https://attack.mitre.org/techniques/T1636/001,01 April 2022,11 April 2022,1.0,,Collection,"On both Android and iOS, the user can manage which applications have permission to access calendar information through the device settings screen, revoke the permission if necessary. Application vetting services could look for `android.permission.READ_CALENDAR` or `android.permission.WRITE_CALENDAR` in an Android application’s manifest, or `NSCalendarsUsageDescription` in an iOS application’s `Info.plist` file. Most applications do not need calendar access, so extra scrutiny could be applied to those that request it. ","Android, iOS",,APP-13,"(Citation: Lookout-StealthMango),(Citation: CyberMerchants-FlexiSpy),(Citation: SWB Exodus March 2019),(Citation: Lookout-Monokle),(Citation: Lookout-PegasusAndroid),"
T1616,Call Control,"Adversaries may make, forward, or block phone calls without user authorization. This could be used for adversary goals such as audio surveillance, blocking or forwarding calls from the device owner, or C2 communication.

Several permissions may be used to programmatically control phone calls, including:

* `ANSWER_PHONE_CALLS` - Allows the application to answer incoming phone calls(Citation: Android Permissions)
* `CALL_PHONE` - Allows the application to initiate a phone call without going through the Dialer interface(Citation: Android Permissions)
* `PROCESS_OUTGOING_CALLS` - Allows the application to see the number being dialed during an outgoing call with the option to redirect the call to a different number or abort the call altogether(Citation: Android Permissions)
* `MANAGE_OWN_CALLS` - Allows a calling application which manages its own calls through the self-managed `ConnectionService` APIs(Citation: Android Permissions)
* `BIND_TELECOM_CONNECTION_SERVICE` - Required permission when using a `ConnectionService`(Citation: Android Permissions)
* `WRITE_CALL_LOG` - Allows an application to write to the device call log, potentially to hide malicious phone calls(Citation: Android Permissions)

When granted some of these permissions, an application can make a phone call without opening the dialer first. However, if an application desires to simply redirect the user to the dialer with a phone number filled in, it can launch an Intent using `Intent.ACTION_DIAL`, which requires no specific permissions. This then requires the user to explicitly initiate the call or use some form of [Input Injection](https://attack.mitre.org/techniques/T1516) to programmatically initiate it.",https://attack.mitre.org/techniques/T1616,20 September 2021,24 October 2022,1.0,"Gaetan van Diemen, ThreatFabric","Collection, Command and Control, Impact","Users can view their default phone app in device settings. Users can review available call logs for irregularities, such as missing or unrecognized calls.",Android,Post-Adversary Device Access,APP-41,"(Citation: SecureList BusyGasper),(Citation: Lookout-Monokle),(Citation: Lookout Uyghur Campaign),(Citation: Cofense Anubis),"
T1636.002,Call Log,"Adversaries may utilize standard operating system APIs to gather call log data. On Android, this can be accomplished using the Call Log Content Provider. iOS provides no standard API to access the call log. 

 

If the device has been jailbroken or rooted, an adversary may be able to access the [Call Log](https://attack.mitre.org/techniques/T1636/002) without the user’s knowledge or approval. ",https://attack.mitre.org/techniques/T1636/002,01 April 2022,29 April 2022,1.0,,Collection,"On Android, the user can manage which applications have permission to access the call log through the device settings screen, revoking the permission if necessary. Application vetting services could look for `android.permission.READ_CALL_LOG` in an Android application’s manifest. Most applications do not need call log access, so extra scrutiny could be applied to those that request it.  ","Android, iOS",Post-Adversary Device Access,APP-13,"(Citation: Talos-WolfRAT),(Citation: PaloAlto-SpyDealer),(Citation: Lookout ViperRAT),(Citation: Zscaler TikTok Spyware),(Citation: Lookout-EnterpriseApps),(Citation: SecureList - ViceLeaker 2019),(Citation: Lookout Uyghur Campaign),(Citation: Zscaler-SuperMarioRun),(Citation: Google Project Zero Insomnia),(Citation: Lookout-Monokle),(Citation: Kaspersky-WUC),(Citation: NYTimes-BackDoor),(Citation: TrendMicro Coronavirus Updates),(Citation: SWB Exodus March 2019),(Citation: Lookout-PegasusAndroid),(Citation: Lookout-Pegasus),(Citation: Lookout-StealthMango),(Citation: Palo Alto HenBox),(Citation: Lookout Dark Caracal Jan 2018),(Citation: Sophos Red Alert 2.0),(Citation: Trend Micro Bouncing Golf 2019),"
T1414,Clipboard Data,"Adversaries may abuse clipboard manager APIs to obtain sensitive information copied to the device clipboard. For example, passwords being copied and pasted from a password manager application could be captured by a malicious application installed on the device.(Citation: Fahl-Clipboard) 

 

On Android, applications can use the `ClipboardManager.OnPrimaryClipChangedListener()` API to register as a listener and monitor the clipboard for changes. However, starting in Android 10, this can only be used if the application is in the foreground, or is set as the device’s default input method editor (IME).(Citation: Github Capture Clipboard 2019)(Citation: Android 10 Privacy Changes) 

 

On iOS, this can be accomplished by accessing the `UIPasteboard.general.string` field. However, starting in iOS 14, upon accessing the clipboard, the user will be shown a system notification if the accessed text originated in a different application. For example, if the user copies the text of an iMessage from the Messages application, the notification will read “application_name has pasted from Messages” when the text was pasted in a different application.(Citation: UIPPasteboard)",https://attack.mitre.org/techniques/T1414,25 October 2017,19 April 2022,3.0,,"Collection, Credential Access",Application vetting services could detect usage of standard clipboard APIs.,"Android, iOS",Post-Adversary Device Access,APP-35,"(Citation: PaloAlto-XcodeGhost),(Citation: TrendMicro-RCSAndroid),(Citation: Trend Micro Bouncing Golf 2019),(Citation: Android 10 Privacy Changes)"
T1632.001,Code Signing Policy Modification,"Adversaries may modify code signing policies to enable execution of applications signed with unofficial or unknown keys. Code signing provides a level of authenticity on an app from a developer, guaranteeing that the program has not been tampered with and comes from an official source. Security controls can include enforcement mechanisms to ensure that only valid, signed code can be run on a device. 

Mobile devices generally enable these security controls by default, such as preventing the installation of unknown applications on Android. Adversaries may modify these policies in a number of ways, including [Input Injection](https://attack.mitre.org/techniques/T1516) or malicious configuration profiles.",https://attack.mitre.org/techniques/T1632/001,30 March 2022,21 April 2022,1.0,,Defense Evasion,"On Android, the user can use the device settings menu to view trusted CA certificates and look for unexpected or unknown certificates. A mobile security product could similarly examine the trusted CA certificate store for anomalies. Users can use the device settings menu to view which applications on the device are allowed to install unknown applications.

On iOS, the user can use the device settings menu to view installed Configuration Profiles and look for unexpected or unknown profiles. A Mobile Device Management (MDM) system could use the iOS MDM APIs to examine the list of installed Configuration Profiles for anomalies.","Android, iOS",Post-Adversary Device Access,STA-7,"(Citation: Lookout Uyghur Campaign),(Citation: SecureList DVMap June 2017),(Citation: Lookout Desert Scorpion),(Citation: TrendMicro-XLoader-FakeSpy),(Citation: BlackBerry Bahamut),(Citation: Bitdefender Mandrake),(Citation: Symantec-iOSProfile2),(Citation: Android-TrustedCA)"
T1623,Command and Scripting Interpreter,"Adversaries may abuse command and script interpreters to execute commands, scripts, or binaries. These interfaces and languages provide ways of interacting with computer systems and are a common feature across many different platforms. Most systems come with some built-in command-line interface and scripting capabilities, for example, Android is a UNIX-like OS and includes a basic [Unix Shell](https://attack.mitre.org/techniques/T1623/001) that can be accessed via the Android Debug Bridge (ADB) or Java’s `Runtime` package.

Adversaries may abuse these technologies in various ways as a means of executing arbitrary commands. Commands and scripts can be embedded in [Initial Access](https://attack.mitre.org/tactics/TA0027) payloads delivered to victims as lure documents or as secondary payloads downloaded from an existing C2. Adversaries may also execute commands through interactive terminals/shells. ",https://attack.mitre.org/techniques/T1623,30 March 2022,06 April 2022,1.0,,Execution,"Command-line activities can potentially be detected through Mobile Threat Defense integrations with lower-level OS APIs. This could grant the MTD agents access to running processes and their parameters, potentially detecting unwanted or malicious shells.

Application vetting services could detect the invocations of methods that could be used to execute shell commands.(Citation: Samsung Knox Mobile Threat Defense)","Android, iOS",Post-Adversary Device Access,,","
T1577,Compromise Application Executable,"Adversaries may modify applications installed on a device to establish persistent access to a victim. These malicious modifications can be used to make legitimate applications carry out adversary tasks when these applications are in use.

There are multiple ways an adversary can inject malicious code into applications. One method is by taking advantages of device vulnerabilities, the most well-known being Janus, an Android vulnerability that allows adversaries to add extra bytes to APK (application) and DEX (executable) files without affecting the file's signature. By being able to add arbitrary bytes to valid applications, attackers can seamlessly inject code into genuine executables without the user's knowledge.(Citation: Guardsquare Janus)

Adversaries may also rebuild applications to include malicious modifications. This can be achieved by decompiling the genuine application, merging it with the malicious code, and recompiling it.(Citation: CheckPoint Agent Smith)

Adversaries may also take action to conceal modifications to application executables and bypass user consent. These actions include altering modifications to appear as an update or exploiting vulnerabilities that allow activities of the malicious application to run inside a system application.(Citation: CheckPoint Agent Smith)",https://attack.mitre.org/techniques/T1577,07 May 2020,24 October 2022,1.0,,Persistence,This behavior is seamless to the user and is typically undetectable.,Android,Post-Adversary Device Access,,"(Citation: CheckPoint Agent Smith),"
T1645,Compromise Client Software Binary,"Adversaries may modify system software binaries to establish persistent access to devices. System software binaries are used by the underlying operating system and users over adb or terminal emulators. 

Adversaries may make modifications to client software binaries to carry out malicious tasks when those binaries are executed. For example, malware may come with a pre-compiled malicious binary intended to overwrite the genuine one on the device. Since these binaries may be routinely executed by the system or user, the adversary can leverage this for persistent access to the device. ",https://attack.mitre.org/techniques/T1645,30 March 2022,08 April 2022,1.0,,Persistence,"Verified Boot can detect unauthorized modifications to the system partition.(Citation: Android-VerifiedBoot) Android’s SafetyNet API provides remote attestation capabilities, which could potentially be used to identify and respond to compromised devices. Samsung Knox provides a similar remote attestation capability on supported Samsung devices. Application vetting services could detect applications trying to modify files in protected parts of the operating system.","Android, iOS",Post-Adversary Device Access,APP-27,"(Citation: Lookout Uyghur Campaign),(Citation: Lookout-Adware),(Citation: Lookout-BrainTest),(Citation: Lookout-Monokle),(Citation: Lookout-PegasusAndroid),(Citation: SecureList BusyGasper),(Citation: PaloAlto-SpyDealer),(Citation: Lookout-Pegasus),"
T1474.002,Compromise Hardware Supply Chain,"Adversaries may manipulate hardware components in products prior to receipt by a final consumer for the purpose of data or system compromise. By modifying hardware or firmware in the supply chain, adversaries can insert a backdoor into consumer networks that may be difficult to detect and give the adversary a high degree of control over the system. ",https://attack.mitre.org/techniques/T1474/002,28 March 2022,05 April 2022,1.0,,Initial Access,Integrity checking mechanisms can potentially detect unauthorized hardware modifications.,"Android, iOS",Post-Adversary Device Access,SPC-1,","
T1474.001,Compromise Software Dependencies and Development Tools,Adversaries may manipulate products or product delivery mechanisms prior to receipt by a final consumer for the purpose of data or system compromise. Applications often depend on external software to function properly. Popular open source projects that are used as dependencies in many applications may be targeted as a means to add malicious code to users of the dependency.(Citation: Grace-Advertisement),https://attack.mitre.org/techniques/T1474/001,28 March 2022,05 April 2022,1.0,,Initial Access,Usage of insecure or malicious third-party libraries could be detected by application vetting services. Malicious software development tools could be detected by enterprises that deploy endpoint protection software on computers that are used to develop mobile apps. Application vetting could detect the usage of insecure or malicious third-party libraries.,"Android, iOS",Post-Adversary Device Access,APP-6,"(Citation: PaloAlto-XcodeGhost1),(Citation: PaloAlto-XcodeGhost),"
T1474.003,Compromise Software Supply Chain,"Adversaries may manipulate application software prior to receipt by a final consumer for the purpose of data or system compromise. Supply chain compromise of software can take place in a number of ways, including manipulation of the application source code, manipulation of the update/distribution mechanism for that software, or replacing compiled releases with a modified version.",https://attack.mitre.org/techniques/T1474/003,28 March 2022,05 April 2022,1.0,,Initial Access,Application vetting services can detect malicious code in applications. System partition integrity checking mechanisms can detect unauthorized or malicious code contained in the system partition.,"Android, iOS",Post-Adversary Device Access,SPC-4,"(Citation: BankInfoSecurity-BackDoor),(Citation: Lookout-StealthMango),(Citation: HackerNews-Allwinner),(Citation: NYTimes-BackDoor),(Citation: CYBERWARCON CHEMISTGAMES),(Citation: Google Triada June 2019),(Citation: Krebs-Triada June 2019),"
T1636.003,Contact List,"Adversaries may utilize standard operating system APIs to gather contact list data. On Android, this can be accomplished using the Contacts Content Provider. On iOS, this can be accomplished using the `Contacts` framework. 

 

If the device has been jailbroken or rooted, an adversary may be able to access the [Contact List](https://attack.mitre.org/techniques/T1636/003) without the user’s knowledge or approval. ",https://attack.mitre.org/techniques/T1636/003,01 April 2022,11 April 2022,1.0,,Collection,"On both Android and iOS, the user can manage which applications have permission to access the contact list through the device settings screen, revoking the permission if necessary. Application vetting services could look for `android.permission.READ_CONTACTS` in an Android application’s manifest, or `NSContactsUsageDescription` in an iOS application’s `Info.plist` file. Most applications do not need contact list access, so extra scrutiny could be applied to those that request it.","Android, iOS",Post-Adversary Device Access,APP-13,"(Citation: ThreatFabric Ginp),(Citation: Threat Fabric Cerberus),(Citation: Talos-WolfRAT),(Citation: securelist rotexy 2018),(Citation: Talos Gustuff Apr 2019),(Citation: Talos GPlayed),(Citation: Cofense Anubis),(Citation: PaloAlto-SpyDealer),(Citation: Zscaler-SpyNote),(Citation: Lookout ViperRAT),(Citation: Lookout-EnterpriseApps),(Citation: Cybereason FakeSpy),(Citation: Bitdefender Mandrake),(Citation: Securelist Asacub),(Citation: Lookout Uyghur Campaign),(Citation: Zscaler TikTok Spyware),(Citation: CheckPoint-Charger),(Citation: Kaspersky Riltok June 2019),(Citation: Google Project Zero Insomnia),(Citation: Threat Fabric Exobot),(Citation: Lookout-Monokle),(Citation: Kaspersky-WUC),(Citation: Lookout eSurv),(Citation: NYTimes-BackDoor),(Citation: CyberMerchants-FlexiSpy),(Citation: TrendMicro Coronavirus Updates),(Citation: SWB Exodus March 2019),(Citation: Lookout Desert Scorpion),(Citation: Lookout-PegasusAndroid),(Citation: Lookout-Pegasus),(Citation: Lookout-StealthMango),(Citation: Symantec GoldenCup),(Citation: Palo Alto HenBox),(Citation: Lookout Dark Caracal Jan 2018),(Citation: Sophos Red Alert 2.0),(Citation: BlackBerry Bahamut),(Citation: Trend Micro Bouncing Golf 2019),"
T1634,Credentials from Password Store,"Adversaries may search common password storage locations to obtain user credentials. Passwords can be stored in several places on a device, depending on the operating system or application holding the credentials. There are also specific applications that store passwords to make it easier for users manage and maintain. Once credentials are obtained, they can be used to perform lateral movement and access restricted information.",https://attack.mitre.org/techniques/T1634,01 April 2022,05 April 2022,1.0,,Credential Access,"Mobile security products can potentially detect jailbroken devices. Application vetting services may be able to detect known privilege escalation exploits contained within applications, as well as searching application packages for strings that correlate to known password store locations.",iOS,Post-Adversary Device Access,AUT-11,","
T1471,Data Encrypted for Impact,An adversary may encrypt files stored on a mobile device to prevent the user from accessing them. This may be done in order to extract monetary compensation from a victim in exchange for decryption or a decryption key (ransomware) or to render data permanently inaccessible in cases where the key is not saved or transmitted.,https://attack.mitre.org/techniques/T1471,25 October 2017,06 April 2022,3.1,,Impact,"Application vetting services may be able to detect if an application attempts to encrypt files, although this may be benign behavior.",Android,Post-Adversary Device Access,APP-28,"(Citation: PaloAlto-Xbot),(Citation: Cofense Anubis),"
T1641,Data Manipulation,"Adversaries may insert, delete, or alter data in order to manipulate external outcomes or hide activity. By manipulating data, adversaries may attempt to affect a business process, organizational understanding, or decision making.

The type of modification and the impact it will have depends on the target application, process, and the goals and objectives of the adversary. For complex systems, an adversary would likely need special expertise and possibly access to specialized software related to the system, typically gained through a prolonged information gathering campaign, in order to have the desired impact.",https://attack.mitre.org/techniques/T1641,06 April 2022,06 April 2022,1.0,,Impact,Application vetting services could look for use of standard APIs (e.g. the clipboard API) that could indicate data manipulation is occurring.,Android,Post-Adversary Device Access,,","
T1533,Data from Local System,"Adversaries may search local system sources, such as file systems or local databases, to find files of interest and sensitive data prior to exfiltration.  

 

Access to local system data, which includes information stored by the operating system, often requires escalated privileges. Examples of local system data include authentication tokens, the device keyboard cache, Wi-Fi passwords, and photos. On Android, adversaries may also attempt to access files from external storage which may require additional storage-related permissions. 

 ",https://attack.mitre.org/techniques/T1533,10 October 2019,01 April 2022,1.1,,Collection,"Accessing data from the local system can be difficult to detect, and therefore enterprises may be better served focusing on detection at other stages of adversarial behavior.","Android, iOS",Post-Adversary Device Access,STA-41,"(Citation: ThreatFabric Ginp),(Citation: Talos-WolfRAT),(Citation: FlexiSpy-Features),(Citation: CYBERWARCON CHEMISTGAMES),(Citation: Talos GPlayed),(Citation: Talos Gustuff Apr 2019),(Citation: Cofense Anubis),(Citation: TrendMicro-RCSAndroid),(Citation: SecureList BusyGasper),(Citation: Lookout ViperRAT),(Citation: Zscaler-SpyNote),(Citation: Zscaler TikTok Spyware),(Citation: SecureList - ViceLeaker 2019),(Citation: Lookout Uyghur Campaign),(Citation: Google Project Zero Insomnia),(Citation: Lookout-Monokle),(Citation: Lookout-Dendroid),(Citation: Lookout eSurv),(Citation: Trend Micro Anubis),(Citation: TrendMicro Coronavirus Updates),(Citation: SWB Exodus March 2019),(Citation: Gooligan Citation),(Citation: Lookout Desert Scorpion),(Citation: SecurityIntelligence TrickMo),(Citation: Bitdefender - Triout 2018),(Citation: Lookout-StealthMango),(Citation: Lookout FrozenCell),(Citation: Symantec GoldenCup),(Citation: Palo Alto HenBox),(Citation: Cylance Dust Storm),(Citation: BlackBerry Bahamut),(Citation: Trend Micro Bouncing Golf 2019),"
T1481.001,Dead Drop Resolver,"Adversaries may use an existing, legitimate external Web service to host information that points to additional command and control (C2) infrastructure. Adversaries may post content, known as a dead drop resolver, on Web services with embedded (and often obfuscated/encoded) domains or IP addresses. Once infected, victims will reach out to and be redirected by these resolvers. 

 

Popular websites and social media, acting as a mechanism for C2, may give a significant amount of cover. This is due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection. 

 

Use of a dead drop resolver may also protect back-end C2 infrastructure from discovery through malware binary analysis, or enable operational resiliency (since this infrastructure may be dynamically changed). ",https://attack.mitre.org/techniques/T1481/001,06 April 2022,06 April 2022,1.0,,Command and Control,"Application vetting services may provide a list of connections made or received by an application, or a list of domains contacted by the application. ","Android, iOS",Post-Adversary Device Access,,"(Citation: Trend Micro Anubis),(Citation: TrendMicro-Anserver),(Citation: Cofense Anubis),(Citation: Sophos Red Alert 2.0),(Citation: TrendMicro-XLoader-FakeSpy),"
T1626.001,Device Administrator Permissions,"Adversaries may abuse Android’s device administration API to obtain a higher degree of control over the device. By abusing the API, adversaries can perform several nefarious actions, such as resetting the device’s password for [Endpoint Denial of Service](https://attack.mitre.org/techniques/T1642), factory resetting the device for [File Deletion](https://attack.mitre.org/techniques/T1630/002) and to delete any traces of the malware, disabling all the device’s cameras, or to make it more difficult to uninstall the app.

Device administrators must be approved by the user at runtime, with a system popup showing which actions have been requested by the app. In conjunction with other techniques, such as [Input Injection](https://attack.mitre.org/techniques/T1516), an app can programmatically grant itself administrator permissions without any user input.",https://attack.mitre.org/techniques/T1626/001,01 April 2022,06 April 2022,1.0,,Privilege Escalation,Users are prompted for approval when an application requests device administrator permissions. Users can see which applications are registered as device administrators in the device settings. Application vetting services can check for the string `BIND_DEVICE_ADMIN` in the application’s manifest. This indicates it can prompt the user for device administrator permissions.,Android,Post-Adversary Device Access,APP-22,"(Citation: Securelist Asacub),(Citation: Proofpoint-Marcher),(Citation: Talos GPlayed),(Citation: Threat Fabric Exobot),(Citation: Sophos Red Alert 2.0),(Citation: TrendMicro-XLoader),(Citation: GoogleIO2016)"
T1629.002,Device Lockout,"An adversary may seek to inhibit user interaction by locking the legitimate user out of the device. This is typically accomplished by requesting device administrator permissions and then locking the screen using `DevicePolicyManager.lockNow()`. Other novel techniques for locking the user out of the device have been observed, such as showing a persistent overlay, using carefully crafted “call” notification screens, and locking HTML pages in the foreground. These techniques can be very difficult to get around, and typically require booting the device into safe mode to uninstall the malware.(Citation: Microsoft MalLockerB)(Citation: Talos GPlayed)(Citation: securelist rotexy 2018)

Prior to Android 7, device administrators were able to reset the device lock passcode to prevent the user from unlocking the device. The release of Android 7 introduced updates that only allow device or profile owners (e.g. MDMs) to reset the device’s passcode.(Citation: Android resetPassword)",https://attack.mitre.org/techniques/T1629/002,01 April 2022,05 April 2022,1.0,,Defense Evasion,Users can view a list of device administrators in device settings and revoke permission where appropriate. Applications that request device administrator permissions should be scrutinized further for malicious behavior.,Android,Post-Adversary Device Access,APP-22,"(Citation: securelist rotexy 2018),(Citation: Microsoft MalLockerB),(Citation: SecurityIntelligence TrickMo),"
T1629.003,Disable or Modify Tools,"Adversaries may disable security tools to avoid potential detection of their tools and activities. This can take the form of disabling security software, modifying SELinux configuration, or other methods to interfere with security tools scanning or reporting information. This is typically done by abusing device administrator permissions or using system exploits to gain root access to the device to modify protected system files.",https://attack.mitre.org/techniques/T1629/003,01 April 2022,05 April 2022,1.0,,Defense Evasion,Users can view a list of active device administrators in the device settings.,Android,Post-Adversary Device Access,,"(Citation: Threat Fabric Cerberus),(Citation: SecureList DVMap June 2017),(Citation: Cofense Anubis),(Citation: Google Security Zen),(Citation: Bitdefender Mandrake),"
T1630.003,Disguise Root/Jailbreak Indicators,"An adversary could use knowledge of the techniques used by security software to evade detection.(Citation: Brodie)(Citation: Tan) For example, some mobile security products perform compromised device detection by searching for particular artifacts such as an installed ""su"" binary, but that check could be evaded by naming the binary something else. Similarly, polymorphic code techniques could be used to evade signature-based detection.(Citation: Rastogi)",https://attack.mitre.org/techniques/T1630/003,08 April 2022,11 April 2022,1.0,,Defense Evasion,Mobile security products can use attestation to detect compromised devices.,"Android, iOS",Post-Adversary Device Access,EMM-5,","
T1637.001,Domain Generation Algorithms,"Adversaries may use [Domain Generation Algorithms](https://attack.mitre.org/techniques/T1637/001) (DGAs) to procedurally generate domain names for uses such as command and control communication   or malicious application distribution.(Citation: securelist rotexy 2018)

DGAs increase the difficulty for defenders to block, track, or take over the command and control channel, as there could potentially be thousands of domains that malware can check for instructions.",https://attack.mitre.org/techniques/T1637/001,05 April 2022,05 April 2022,1.0,,Command and Control,"Detecting dynamically generated domains can be challenging due to the number of different DGA algorithms, constantly evolving malware families, and the increasing complexity of the algorithms. There are a myriad of approaches for detecting a pseudo-randomly generated domain name, including using frequency analysis, Markov chains, entropy, proportion of dictionary words, ratio of vowels to other characters, and more.(Citation: Data Driven Security DGA) CDN domains may trigger these detections due to the format of their domain names. In addition to detecting a DGA domain based on the name, a more general approach for detecting a suspicious domain is to check for recently registered names ","Android, iOS",Post-Adversary Device Access,,"(Citation: securelist rotexy 2018),(Citation: Bitdefender Mandrake),"
T1407,Download New Code at Runtime,"Adversaries may download and execute dynamic code not included in the original application package after installation. This technique is primarily used to evade static analysis checks and pre-publication scans in official app stores. In some cases, more advanced dynamic or behavioral analysis techniques could detect this behavior. However, in conjunction with [Execution Guardrails](https://attack.mitre.org/techniques/T1627) techniques, detecting malicious code downloaded after installation could be difficult.

On Android, dynamic code could include native code, Dalvik code, or JavaScript code that utilizes Android WebView’s `JavascriptInterface` capability. 

On iOS, dynamic code could be downloaded and executed through 3rd party libraries such as JSPatch. (Citation: FireEye-JSPatch) ",https://attack.mitre.org/techniques/T1407,25 October 2017,06 April 2022,1.3,,Defense Evasion,"Existing network infrastructure may detect network calls to known malicious domains or the transfer of malicious payloads over the network. Mobile security products may provide URL inspection services that could determine if a domain being visited is malicious. Application vetting services could look for indications that the application downloads and executes new code at runtime (e.g., on Android, use of `DexClassLoader`, `System.load`, or the WebView `JavaScriptInterface` capability; on iOS, use of JSPatch or similar capabilities). Unfortunately, this is only a partial mitigation, as additional scrutiny would still need to be applied to applications that use these techniques. These techniques are often used without malicious intent, and  applications may employ other techniques to hide their use of these techniques.","Android, iOS",Post-Adversary Device Access,APP-20,"(Citation: CheckPoint-Judy),(Citation: Threat Fabric Cerberus),(Citation: Talos-WolfRAT),(Citation: CYBERWARCON CHEMISTGAMES),(Citation: Talos GPlayed),(Citation: TrendMicro-RCSAndroid),(Citation: SecureList BusyGasper),(Citation: PaloAlto-SpyDealer),(Citation: Lookout ViperRAT),(Citation: Bitdefender Mandrake),(Citation: Lookout Uyghur Campaign),(Citation: WhiteOps TERRACOTTA),(Citation: Lookout-BrainTest),(Citation: Kaspersky-Skygofree),(Citation: Cybereason EventBot),(Citation: Lookout eSurv),(Citation: Trend Micro Anubis),(Citation: SWB Exodus March 2019),(Citation: Lookout Desert Scorpion),(Citation: Google Triada June 2019),(Citation: Xiao-ZergHelper),(Citation: Google Bread),(Citation: Lookout FrozenCell),(Citation: Symantec GoldenCup),(Citation: Palo Alto HenBox),(Citation: SecureList DVMap June 2017),(Citation: Sophos Red Alert 2.0),(Citation: Google Security Zen),(Citation: BlackBerry Bahamut),(Citation: Android 10 Execute)"
T1456,Drive-By Compromise,"Adversaries may gain access to a system through a user visiting a website over the normal course of browsing. With this technique, the user's web browser is typically targeted for exploitation, but adversaries may also use compromised websites for non-exploitation behavior such as acquiring an [Application Access Token](https://attack.mitre.org/techniques/T1550/001).

Multiple ways of delivering exploit code to a browser exist, including:

* A legitimate website is compromised where adversaries have injected some form of malicious code such as JavaScript, iFrames, and cross-site scripting.
* Malicious ads are paid for and served through legitimate ad providers.
* Built-in web application interfaces are leveraged for the insertion of any other kind of object that can be used to display web content or contain a script that executes on the visiting client (e.g. forum posts, comments, and other user controllable web content).

Often the website used by an adversary is one visited by a specific community, such as government, a particular industry, or region, where the goal is to compromise a specific user or set of users based on a shared interest. This kind of targeted attack is referred to a strategic web compromise or watering hole attack. There are several known examples of this occurring.(Citation: Lookout-StealthMango)

Typical drive-by compromise process:

1. A user visits a website that is used to host the adversary controlled content.
2. Scripts automatically execute, typically searching versions of the browser and plugins for a potentially vulnerable version. 
    * The user may be required to assist in this process by enabling scripting or active website components and ignoring warning dialog boxes.
3. Upon finding a vulnerable version, exploit code is delivered to the browser.
4. If exploitation is successful, then it will give the adversary code execution on the user's system unless other protections are in place.
    * In some cases a second visit to the website after the initial scan is required before exploit code is delivered.",https://attack.mitre.org/techniques/T1456,25 October 2017,19 April 2022,2.0,,Initial Access,Mobile security products can often alert the user if their device is vulnerable to known exploits.,"Android, iOS",Post-Adversary Device Access,CEL-22,"(Citation: Lookout-StealthMango),(Citation: Volexity Insomnia),(Citation: Lookout-Pegasus),"
T1637,Dynamic Resolution,"Adversaries may dynamically establish connections to command and control infrastructure to evade common detections and remediations. This may be achieved by using malware that shares a common algorithm with the infrastructure the adversary uses to receive the malware's communications. This algorithm can be used to dynamically adjust parameters such as the domain name, IP address, or port number the malware uses for command and control.",https://attack.mitre.org/techniques/T1637,05 April 2022,05 April 2022,1.0,,Command and Control,"Detecting dynamically generated domains can be challenging due to the number of different Domain Generation Algorithms (DGAs), constantly evolving malware families, and the increasing complexity of the algorithms. There are a myriad of approaches for detecting a pseudo-randomly generated domain name, including using frequency analysis, Markov chains, entropy, proportion of dictionary words, ratio of vowels to other characters, and more.(Citation: Data Driven Security DGA) Content delivery network (CDN) domains may trigger these detections due to the format of their domain names. In addition to detecting a DGA domain based on the name, a more general approach for detecting a suspicious domain is to check for recently registered names or rarely visited domains.","Android, iOS",Post-Adversary Device Access,,","
T1521,Encrypted Channel,"Adversaries may explicitly employ a known encryption algorithm to conceal command and control traffic rather than relying on any inherent protections provided by a communication protocol. Despite the use of a secure algorithm, these implementations may be vulnerable to reverse engineering if necessary secret keys are encoded and/or generated within malware samples/configuration files.",https://attack.mitre.org/techniques/T1521,01 October 2019,05 April 2022,2.0,,Command and Control,"Since data encryption is a common practice in many legitimate applications and uses standard programming language-specific APIs, encrypting data for command and control communication is regarded as undetectable to the user.","Android, iOS",Post-Adversary Device Access,,"(Citation: ESET-Twitoor),"
T1642,Endpoint Denial of Service,"Adversaries may perform Endpoint Denial of Service (DoS) attacks to degrade or block the availability of services to users.

On Android versions prior to 7, apps can abuse Device Administrator access to reset the device lock passcode, preventing the user from unlocking the device. After Android 7, only device or profile owners (e.g. MDMs) can reset the device’s passcode.(Citation: Android resetPassword)

On iOS devices, this technique does not work because mobile device management servers can only remove the screen lock passcode; they cannot set a new passcode. However, on jailbroken devices, malware has been discovered that can lock the user out of the device.(Citation: Xiao-KeyRaider)",https://attack.mitre.org/techniques/T1642,06 April 2022,19 April 2022,1.0,,Impact,"On Android, users can review which applications have Device Administrator access in the device settings and revoke permission where appropriate. Application vetting services can detect and closely scrutinize applications that utilize Device Administrator access.","Android, iOS",Post-Adversary Device Access,,"(Citation: PaloAlto-Xbot),(Citation: Threat Fabric Exobot),(Citation: CheckPoint-Charger),(Citation: Talos GPlayed),"
T1624,Event Triggered Execution,"Adversaries may establish persistence using system mechanisms that trigger execution based on specific events. Mobile operating systems have means to subscribe to events such as receiving an SMS message, device boot completion, or other device activities. 

Adversaries may abuse these mechanisms as a means of maintaining persistent access to a victim via automatically and repeatedly executing malicious code. After gaining access to a victim’s system, adversaries may create or modify event triggers to point to malicious content that will be executed whenever the event trigger is invoked. ",https://attack.mitre.org/techniques/T1624,30 March 2022,29 April 2022,1.0,,Persistence,Application vetting services can detect which broadcast intents an application registers for and which permissions it requests. ,Android,Post-Adversary Device Access,,",(Citation: Android Changes to System Broadcasts)"
T1627,Execution Guardrails,"Adversaries may use execution guardrails to constrain execution or actions based on adversary supplied and environment specific conditions that are expected to be present on the target. Guardrails ensure that a payload only executes against an intended target and reduces collateral damage from an adversary’s campaign. Values an adversary can provide about a target system or environment to use as guardrails may include environment information such as location.(Citation: SWB Exodus March 2019)

Guardrails can be used to prevent exposure of capabilities in environments that are not intended to be compromised or operated within. This use of guardrails is distinct from typical [System Checks](https://attack.mitre.org/techniques/T1633/001). While use of [System Checks](https://attack.mitre.org/techniques/T1633/001) may involve checking for known sandbox values and continuing with execution only if there is no match, the use of guardrails will involve checking for an expected target-specific value and only continuing with execution if there is such a match.",https://attack.mitre.org/techniques/T1627,30 March 2022,11 April 2022,1.0,,Defense Evasion,Detecting the use of guardrails may be difficult depending on the implementation. Users can review which applications have location and sensitive phone information permissions in the operating system’s settings menu. Application vetting services can detect unnecessary and potentially permissions or API calls.,"Android, iOS",Post-Adversary Device Access,,","
T1639,Exfiltration Over Alternative Protocol,"Adversaries may steal data by exfiltrating it over a different protocol than that of the existing command and control channel. The data may also be sent to an alternate network location from the main command and control server. 

Alternate protocols include FTP, SMTP, HTTP/S, DNS, SMB, or any other network protocol not being used as the main command and control channel. Different protocol channels could also include Web services such as cloud storage. Adversaries may opt to also encrypt and/or obfuscate these alternate channels. ",https://attack.mitre.org/techniques/T1639,06 April 2022,29 April 2022,1.0,,Exfiltration,"Exfiltration Over Alternative Protocols can be difficult to detect, and therefore enterprises may be better served focusing on detection at other stages of adversarial behavior.","Android, iOS",Post-Adversary Device Access,APP-30,","
T1646,Exfiltration Over C2 Channel,Adversaries may steal data by exfiltrating it over an existing command and control channel. Stolen data is encoded into the normal communications channel using the same protocol as command and control communications.,https://attack.mitre.org/techniques/T1646,01 April 2022,08 April 2022,1.0,,Exfiltration,"Exfiltration over C2 channel can be difficult to detect, and therefore enterprises may be better served focusing on detection at other stages of adversarial behavior.","Android, iOS",Post-Adversary Device Access,APP-29,"(Citation: SecureList - ViceLeaker 2019),(Citation: Lookout Uyghur Campaign),(Citation: Lookout eSurv),(Citation: TrendMicro-XLoader-FakeSpy),(Citation: Lookout Dark Caracal Jan 2018),(Citation: Bitdefender - Triout 2018),(Citation: Google Triada June 2019),(Citation: Cylance Dust Storm),(Citation: Wandera-RedDrop),(Citation: Trend Micro Bouncing Golf 2019),"
T1639.001,Exfiltration Over Unencrypted Non-C2 Protocol,"Adversaries may steal data by exfiltrating it over an un-encrypted network protocol other than that of the existing command and control channel. The data may also be sent to an alternate network location from the main command and control server.

Adversaries may opt to obfuscate this data, without the use of encryption, within network protocols that are natively unencrypted (such as HTTP, FTP, or DNS). Adversaries may employ custom or publicly available encoding/compression algorithms (such as base64) or embed data within protocol headers and fields.",https://attack.mitre.org/techniques/T1639/001,06 April 2022,06 April 2022,1.0,,Exfiltration,"Exfiltration Over Alternative Protocols can be difficult to detect, and therefore enterprises may be better served focusing on detection at other stages of adversarial behavior.","Android, iOS",Post-Adversary Device Access,APP-30,"(Citation: SecureList BusyGasper),(Citation: TrendMicro Coronavirus Updates),"
T1404,Exploitation for Privilege Escalation,"Adversaries may exploit software vulnerabilities in order to to elevate privileges. Exploitation of a software vulnerability occurs when an adversary takes advantage of a programming error in an application, service, within the operating system software, or kernel itself to execute adversary-controlled code. Security constructions, such as permission levels, will often hinder access to information and use of certain techniques. Adversaries will likely need to perform privilege escalation to include use of software exploitation to circumvent those restrictions. 

When initially gaining access to a device, an adversary may be operating within a lower privileged process which will prevent them from accessing certain resources on the system. Vulnerabilities may exist, usually in operating system components and applications running at higher permissions, that can be exploited to gain higher levels of access on the system. This could enable someone to move from unprivileged or user- level permission to root permissions depending on the component that is vulnerable. ",https://attack.mitre.org/techniques/T1404,25 October 2017,30 March 2022,2.0,,Privilege Escalation,Mobile security products can potentially utilize device APIs to determine if a device has been rooted or jailbroken.  Application vetting services could potentially determine if an application contains code designed to exploit vulnerabilities.,"Android, iOS",Post-Adversary Device Access,APP-26,"(Citation: Lookout Uyghur Campaign),(Citation: ArsTechnica-HummingBad),(Citation: Lookout-Adware),(Citation: Lookout-BrainTest),(Citation: SWB Exodus March 2019),(Citation: Kaspersky-Skygofree),(Citation: Gooligan Citation),(Citation: PaloAlto-SpyDealer),(Citation: SecureList DVMap June 2017),(Citation: Lookout Dark Caracal Jan 2018),(Citation: Volexity Insomnia),(Citation: Lookout-PegasusAndroid),(Citation: Google Security Zen),(Citation: CheckPoint Agent Smith),(Citation: Lookout-Pegasus),"
T1428,Exploitation of Remote Services,"Adversaries may exploit remote services of enterprise servers, workstations, or other resources to gain unauthorized access to internal systems once inside of a network. Adversaries may exploit remote services by taking advantage of a mobile device’s access to an internal enterprise network through local connectivity or through a Virtual Private Network (VPN). Exploitation of a software vulnerability occurs when an adversary takes advantage of a programming error in a program, service, or within the operating system software or kernel itself to execute adversary-controlled code. A common goal for post-compromise exploitation of remote services is for lateral movement to enable access to a remote system. 

An adversary may need to determine if the remote system is in a vulnerable state, which may be done through [Network Service Scanning](https://attack.mitre.org/techniques/T1423) or other Discovery methods. These look for common, vulnerable software that may be deployed in the network, the lack of certain patches that may indicate vulnerabilities, or security software that may be used to detect or contain remote exploitation. Servers are likely a high value target for lateral movement exploitation, but endpoint systems may also be at risk if they provide an advantage or access to additional resources.

Depending on the permissions level of the vulnerable remote service, an adversary may achieve [Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1404) as a result of lateral movement exploitation as well. ",https://attack.mitre.org/techniques/T1428,25 October 2017,06 April 2022,1.1,,Lateral Movement,"Detecting software exploitation initiated by a mobile device may be difficult depending on the tools available. Software exploits may not always succeed or may cause the exploited process to become unstable or crash.

Network traffic analysis could reveal patterns of compromise if devices attempt to access unusual targets or resources. 

Application vetting may be able to identify applications that perform Discovery or utilize existing connectivity to remotely access hosts within an internal enterprise network. ","Android, iOS",Post-Adversary Device Access,APP-32,"(Citation: TrendMicro-DressCode),(Citation: Lookout-NotCompatible),"
T1630.002,File Deletion,"Adversaries may wipe a device or delete individual files in order to manipulate external outcomes or hide activity. An application must have administrator access to fully wipe the device, while individual files may not require special permissions to delete depending on their storage location.(Citation: Android DevicePolicyManager 2019) 

Stored data could include a variety of file formats, such as Office files, databases, stored emails, and custom file formats. The impact file deletion will have depends on the type of data as well as the goals and objectives of the adversary, but can include deleting update files to evade detection or deleting attacker-specified files for impact.",https://attack.mitre.org/techniques/T1630/002,30 March 2022,21 April 2022,1.0,,Defense Evasion,"Mobile security products can detect which applications can request device administrator permissions. Users can view applications with administrator access through the device settings, and may also notice if user data is inexplicably missing. Application vetting services could be extra scrutinous of applications that request device administrator permissions.",Android,Post-Adversary Device Access,,"(Citation: SecureList - ViceLeaker 2019),(Citation: Lookout Uyghur Campaign),(Citation: Talos-WolfRAT),(Citation: CyberMerchants-FlexiSpy),(Citation: Talos GPlayed),(Citation: Zscaler TikTok Spyware),(Citation: Lookout Dark Caracal Jan 2018),(Citation: Lookout Desert Scorpion),(Citation: Lookout-Monokle),(Citation: CheckPoint Agent Smith),(Citation: Bitdefender Mandrake),(Citation: Trend Micro Bouncing Golf 2019),"
T1420,File and Directory Discovery,"Adversaries may enumerate files and directories or search in specific device locations for desired information within a filesystem. Adversaries may use the information from [File and Directory Discovery](https://attack.mitre.org/techniques/T1420) during automated discovery to shape follow-on behaviors, including deciding if the adversary should fully infect the target and/or attempt specific actions. 

On Android, Linux file permissions and SELinux policies typically stringently restrict what can be accessed by apps without taking advantage of a privilege escalation exploit. The contents of the external storage directory are generally visible, which could present concerns if sensitive data is inappropriately stored there. iOS's security architecture generally restricts the ability to perform any type of [File and Directory Discovery](https://attack.mitre.org/techniques/T1420) without use of escalated privileges. ",https://attack.mitre.org/techniques/T1420,25 October 2017,19 April 2022,1.1,,Discovery,"On Android, users are presented with a permissions popup when an application requests access to external device storage.","Android, iOS",Post-Adversary Device Access,STA-41,"(Citation: Lookout Uyghur Campaign),(Citation: Lookout FrozenCell),(Citation: Symantec GoldenCup),(Citation: Lookout Desert Scorpion),(Citation: Cylance Dust Storm),(Citation: BlackBerry Bahamut),(Citation: Zscaler TikTok Spyware),"
T1541,Foreground Persistence,"Adversaries may abuse Android's `startForeground()` API method to maintain continuous sensor access. Beginning in Android 9, idle applications running in the background no longer have access to device sensors, such as the camera, microphone, and gyroscope.(Citation: Android-SensorsOverview) Applications can retain sensor access by running in the foreground, using Android’s `startForeground()` API method. This informs the system that the user is actively interacting with the application, and it should not be killed. The only requirement to start a foreground service is showing a persistent notification to the user.(Citation: Android-ForegroundServices)

Malicious applications may abuse the `startForeground()` API method to continue running in the foreground, while presenting a notification to the user pretending to be a genuine application. This would allow unhindered access to the device’s sensors, assuming permission has been previously granted.(Citation: BlackHat Sutter Android Foreground 2019)

Malicious applications may also abuse the `startForeground()` API to inform the Android system that the user is actively interacting with the application, thus preventing it from being killed by the low memory killer.(Citation: TrendMicro-Yellow Camera)",https://attack.mitre.org/techniques/T1541,19 November 2019,08 April 2022,2.0,"Lorin Wu, Trend Micro","Defense Evasion, Persistence","Users can see persistent notifications in their notification drawer and can subsequently uninstall applications that do not belong. Applications could be vetted for their use of the `startForeground()` API, and could be further scrutinized if usage is found.",Android,Post-Adversary Device Access,APP-19,"(Citation: WhiteOps TERRACOTTA),(Citation: Bitdefender Mandrake),(Citation: Zscaler TikTok Spyware),"
T1417.002,GUI Input Capture,"Adversaries may mimic common operating system GUI components to prompt users for sensitive information with a seemingly legitimate prompt. The operating system and installed applications often have legitimate needs to prompt the user for sensitive information such as account credentials, bank account information, or Personally Identifiable Information (PII). Compared to traditional PCs, the constrained display size of mobile devices may impair the ability to provide users with contextual information, making users more susceptible to this technique’s use.(Citation: Felt-PhishingOnMobileDevices)

There are several approaches adversaries may use to mimic this functionality. Adversaries may impersonate the identity of a legitimate application (e.g. use the same application name and/or icon) and, when installed on the device, may prompt the user for sensitive information.(Citation: eset-finance) Adversaries may also send fake device notifications to the user that may trigger the display of an input prompt when clicked.(Citation: Group IB Gustuff Mar 2019) 

Additionally, adversaries may display a prompt on top of a running, legitimate application to trick users into entering sensitive information into a malicious application rather than the legitimate application. Typically, adversaries need to know when the targeted application and the individual activity within the targeted application is running in the foreground to display the prompt at the proper time. Adversaries can abuse Android’s accessibility features to determine which application is currently in the foreground.(Citation: ThreatFabric Cerberus) Two known approaches to displaying a prompt include:

* Adversaries start a new activity on top of a running legitimate application.(Citation: Felt-PhishingOnMobileDevices)(Citation: Hassell-ExploitingAndroid) Android 10 places new restrictions on the ability for an application to start a new activity on top of another application, which may make it more difficult for adversaries to utilize this technique.(Citation: Android Background)
* Adversaries create an application overlay window on top of a running legitimate application. Applications must hold the `SYSTEM_ALERT_WINDOW` permission to create overlay windows. This permission is handled differently than typical Android permissions and, at least under certain conditions, is automatically granted to applications installed from the Google Play Store.(Citation: Cloak and Dagger)(Citation: NowSecure Android Overlay)(Citation: Skycure-Accessibility) The `SYSTEM_ALERT_WINDOW` permission and its associated ability to create application overlay windows are expected to be deprecated in a future release of Android in favor of a new API.(Citation: XDA Bubbles)",https://attack.mitre.org/techniques/T1417/002,05 April 2022,05 April 2022,1.0,,"Collection, Credential Access","Android users can view and manage which applications hold the `SYSTEM_ALERT_WINDOW` permission through the device settings in Apps & notifications -> Special app access -> Display over other apps (the exact menu location may vary between Android versions). 

Application vetting services can look for applications requesting the `android.permission.SYSTEM_ALERT_WINDOW` permission in the list of permissions in the app manifest. ","Android, iOS",Post-Adversary Device Access,APP-31,"(Citation: ThreatFabric Ginp),(Citation: Threat Fabric Cerberus),(Citation: securelist rotexy 2018),(Citation: Talos Gustuff Apr 2019),(Citation: Talos GPlayed),(Citation: Cofense Anubis),(Citation: Zscaler TikTok Spyware),(Citation: Bitdefender Mandrake),(Citation: Group IB Gustuff Mar 2019),(Citation: WhiteOps TERRACOTTA),(Citation: PaloAlto-XcodeGhost),(Citation: Kaspersky Riltok June 2019),(Citation: Threat Fabric Exobot),(Citation: Cybereason EventBot),(Citation: Lookout-Dendroid),(Citation: Proofpoint-Marcher),(Citation: PaloAlto-Xbot),(Citation: Lookout Dark Caracal Jan 2018),(Citation: Sophos Red Alert 2.0),(Citation: Android 12 Features)"
T1643,Generate Traffic from Victim,"Adversaries may generate outbound traffic from devices. This is typically performed to manipulate external outcomes, such as to achieve carrier billing fraud or to manipulate app store rankings or ratings. Outbound traffic is typically generated as SMS messages or general web traffic, but may take other forms as well.

If done via SMS messages, Android apps must hold the `SEND_SMS` permission. Additionally, sending an SMS message requires user consent if the recipient is a premium number. Applications cannot send SMS messages on iOS",https://attack.mitre.org/techniques/T1643,06 April 2022,06 April 2022,1.0,,Impact,"On Android, users can review which applications can use premium SMS features in the “Special access” page within application settings. Application vetting services can detect when applications request the `SEND_SMS` permission, which should be infrequently used.","Android, iOS",Post-Adversary Device Access,APP-16,"(Citation: WhiteOps TERRACOTTA),(Citation: ArsTechnica-HummingWhale),(Citation: Google Bread),(Citation: CheckPoint-Judy),(Citation: Kaspersky Triada June 2016),(Citation: ArsTechnica-HummingBad),(Citation: Lookout-BrainTest),(Citation: Gooligan Citation),(Citation: Google Security Zen),(Citation: WeLiveSecurity AdDisplayAshas),(Citation: CheckPoint SimBad 2019),(Citation: Google Triada June 2019),(Citation: Tripwire-MazarBOT),(Citation: CheckPoint Agent Smith),(Citation: Wandera-RedDrop),(Citation: Lookout-EnterpriseApps),"
T1627.001,Geofencing,"Adversaries may use a device’s geographical location to limit certain malicious behaviors. For example, malware operators may limit the distribution of a second stage payload to certain geographic regions.(Citation: Lookout eSurv)

[Geofencing](https://attack.mitre.org/techniques/T1627/001) is accomplished by persuading the user to grant the application permission to access location services. The application can then collect, process, and exfiltrate the device’s location to perform location-based actions, such as ceasing malicious behavior or showing region-specific advertisements. 

One method to accomplish [Geofencing](https://attack.mitre.org/techniques/T1627/001) on Android is to use the built-in Geofencing API to automatically trigger certain behaviors when the device enters or exits a specified radius around a geographical location. Similar to  other [Geofencing](https://attack.mitre.org/techniques/T1627/001) methods, this requires that the user has granted the `ACCESS_FINE_LOCATION` and `ACCESS_BACKGROUND_LOCATION` permissions. The latter is only required if the application targets Android 10 (API level 29) or higher. However, Android 11 introduced additional permission controls that may restrict background location collection based on user permission choices at runtime. These additional controls include ""Allow only while using the app"", which will effectively prohibit background location collection.  

Similarly, on iOS, developers can use built-in APIs to setup and execute geofencing. Depending on the use case, the app will either need to call `requestWhenInUseAuthorization()` or `requestAlwaysAuthorization()`, depending on when access to the location services is required. Similar to Android, users also have the option to limit when the application can access the device’s location, including one-time use and only when the application is running in the foreground.  

[Geofencing](https://attack.mitre.org/techniques/T1627/001) can be used to prevent exposure of capabilities in environments that are not intended to be compromised or operated within. For example, location data could be used to limit malware spread and/or capabilities, which could also potentially evade application analysis environments (ex: malware analysis outside of the target geographic area). Other malicious usages could include showing language-specific input prompts and/or advertisements.",https://attack.mitre.org/techniques/T1627/001,30 March 2022,21 April 2022,1.0,,Defense Evasion,"Users can review which applications have location permissions in the operating system’s settings menu. On Android 10 and later, the system shows a notification to the user when an app has been accessing device location in the background. Application vetting services can detect unnecessary and potentially abused location permissions or API calls.","Android, iOS",Post-Adversary Device Access,,"(Citation: BlackBerry Bahamut),(Citation: Lookout eSurv),"
T1628,Hide Artifacts,"Adversaries may attempt to hide artifacts associated with their behaviors to evade detection. Mobile operating systems have features and developer APIs to hide various artifacts, such as an application’s launcher icon. These APIs have legitimate usages, such as hiding an icon to avoid application drawer clutter when an application does not have a usable interface. Adversaries may abuse these features and APIs to hide artifacts from the user to evade detection.",https://attack.mitre.org/techniques/T1628,30 March 2022,08 April 2022,1.0,,Defense Evasion,The user can examine the list of all installed applications in the device settings. Application vetting services could potentially detect the usage of APIs intended for artifact hiding.,Android,Post-Adversary Device Access,,","
T1625,Hijack Execution Flow,"Adversaries may execute their own malicious payloads by hijacking the way operating systems run applications. Hijacking execution flow can be for the purposes of persistence since this hijacked execution may reoccur over time. 

There are many ways an adversary may hijack the flow of execution. A primary way is by manipulating how the operating system locates programs to be executed. How the operating system locates libraries to be used by a program can also be intercepted. Locations where the operating system looks for programs or resources, such as file directories, could also be poisoned to include malicious payloads.",https://attack.mitre.org/techniques/T1625,30 March 2022,05 April 2022,1.0,,Persistence,Mobile threat defense agents could detect unauthorized operating system modifications by using attestation.,Android,Post-Adversary Device Access,APP-27,",(Citation: Android-VerifiedBoot)"
T1617,Hooking,"Adversaries may utilize hooking to hide the presence of artifacts associated with their behaviors to evade detection. Hooking can be used to modify return values or data structures of system APIs and function calls. This process typically involves using 3rd party root frameworks, such as Xposed or Magisk, with either a system exploit or pre-existing root access. By including custom modules for root frameworks, adversaries can hook system APIs and alter the return value and/or system data structures to alter functionality/visibility of various aspects of the system.",https://attack.mitre.org/techniques/T1617,24 September 2021,24 October 2022,1.0,"Jörg Abraham, EclecticIQ",Defense Evasion,"Hooking can be difficult to detect, and therefore enterprises may be better served focusing on detection at other stages of adversarial behavior.",Android,Post-Adversary Device Access,,"(Citation: Lookout-Monokle),"
T1629,Impair Defenses,"Adversaries may maliciously modify components of a victim environment in order to hinder or disable defensive mechanisms. This not only involves impairing preventative defenses, such as anti-virus, but also detection capabilities that defenders can use to audit activity and identify malicious behavior. This may span both native defenses as well as supplemental capabilities installed by users or mobile endpoint administrators.",https://attack.mitre.org/techniques/T1629,01 April 2022,05 April 2022,1.0,,Defense Evasion,Mobile security products integrated with Samsung Knox for Mobile Threat Defense can monitor processes to see if security tools are killed or stop running. Application vetting can detect many techniques associated with impairing device defenses.(Citation: Samsung Knox Mobile Threat Defense),Android,Post-Adversary Device Access,APP-22,","
T1430.002,Impersonate SS7 Nodes,"Adversaries may exploit the lack of authentication in signaling system network nodes to track the to track the location of mobile devices by impersonating a node.(Citation: Engel-SS7)(Citation: Engel-SS7-2008)(Citation: 3GPP-Security)(Citation: Positive-SS7)(Citation: CSRIC5-WG10-FinalReport) 

 

By providing the victim’s MSISDN (phone number) and impersonating network internal nodes to query subscriber information from other nodes, adversaries may use data collected from each hop to eventually determine the device’s geographical cell area or nearest cell tower.(Citation: Engel-SS7)",https://attack.mitre.org/techniques/T1430/002,05 April 2022,21 October 2022,1.0,,"Collection, Discovery","Network carriers may be able to use firewalls, Intrusion Detection Systems (IDS), or Intrusion Prevention Systems (IPS) to detect and/or block SS7 exploitation.(Citation: CSRIC-WG1-FinalReport) The CSRIC also suggests threat information sharing between telecommunications industry members.","Android, iOS",,CEL-38,"(Citation: CitizenLab Circles),(Citation: CSRIC-WG1-FinalReport)"
T1630,Indicator Removal on Host,"Adversaries may delete, alter, or hide generated artifacts on a device, including files, jailbreak status, or the malicious application itself. These actions may interfere with event collection, reporting, or other notifications used to detect intrusion activity. This may compromise the integrity of mobile security solutions by causing notable events or information to go unreported.",https://attack.mitre.org/techniques/T1630,30 March 2022,08 April 2022,1.0,,Defense Evasion,"Mobile security products can detect which applications can request device administrator permissions. Users can view applications with administrator access through the device settings, and may also notice if user data is inexplicably missing. Users can see a list of applications that can use accessibility services in the device settings. Application vetting services could look for use of APIs that could indicate the application is trying to hide activity.","Android, iOS",Post-Adversary Device Access,APP-43,","
T1544,Ingress Tool Transfer,Adversaries may transfer tools or other files from an external system onto a compromised device to facilitate follow-on actions. Files may be copied from an external adversary-controlled system through the command and control channel  or through alternate protocols with another tool such as FTP.,https://attack.mitre.org/techniques/T1544,21 January 2020,06 April 2022,2.0,,Command and Control,Application vetting services could look for connections to unknown domains or IP addresses. Application vetting services may indicate precisely what content was requested during application execution.,"Android, iOS",Post-Adversary Device Access,,"(Citation: SecureList - ViceLeaker 2019),(Citation: Wandera-RedDrop),(Citation: Lookout-Monokle),(Citation: Bitdefender Mandrake),"
T1417,Input Capture,"Adversaries may use methods of capturing user input to obtain credentials or collect information. During normal device usage, users often provide credentials to various locations, such as login pages/portals or system dialog boxes. Input capture mechanisms may be transparent to the user (e.g. [Keylogging](https://attack.mitre.org/techniques/T1417/001)) or rely on deceiving the user into providing input into what they believe to be a genuine application prompt (e.g. [GUI Input Capture](https://attack.mitre.org/techniques/T1417/002)).",https://attack.mitre.org/techniques/T1417,25 October 2017,11 April 2022,2.2,,"Collection, Credential Access",Application vetting services can look for applications requesting the permissions granting access to accessibility services or application overlay. Users can view and manage installed third-party keyboards.,"Android, iOS",Post-Adversary Device Access,APP-31,",(Citation: Android 12 Features),(Citation: Samsung Keyboards)"
T1516,Input Injection,"A malicious application can inject input to the user interface to mimic user interaction through the abuse of Android's accessibility APIs.

[Input Injection](https://attack.mitre.org/techniques/T1516) can be achieved using any of the following methods:

* Mimicking user clicks on the screen, for example to steal money from a user's PayPal account.(Citation: android-trojan-steals-paypal-2fa)
* Injecting global actions, such as `GLOBAL_ACTION_BACK` (programatically mimicking a physical back button press), to trigger actions on behalf of the user.(Citation: Talos Gustuff Apr 2019)
* Inserting input into text fields on behalf of the user. This method is used legitimately to auto-fill text fields by applications such as password managers.(Citation: bitwarden autofill logins)",https://attack.mitre.org/techniques/T1516,15 September 2019,24 October 2022,1.1,"Lukáš Štefanko, ESET","Defense Evasion, Impact",Users can view applications that have registered accessibility services in the accessibility menu within the device settings.,Android,Post-Adversary Device Access,,"(Citation: ThreatFabric Ginp),(Citation: WhiteOps TERRACOTTA),(Citation: Threat Fabric Cerberus),(Citation: Talos Gustuff Apr 2019),(Citation: Kaspersky Riltok June 2019),(Citation: SecurityIntelligence TrickMo),(Citation: CheckPoint Cerberus),(Citation: ESET DEFENSOR ID),(Citation: Google Security Zen),(Citation: Bitdefender Mandrake),"
T1634.001,Keychain,"Adversaries may collect keychain data from an iOS device to acquire credentials. Keychains are the built-in way for iOS to keep track of users' passwords and credentials for many services and features such as Wi-Fi passwords, websites, secure notes, certificates, private keys, and VPN credentials. 

On the device, the keychain database is stored outside of application sandboxes to prevent unauthorized access to the raw data. Standard iOS APIs allow applications access to their own keychain contained within the database. By utilizing a privilege escalation exploit or existing root access, adversaries can access the entire encrypted database.(Citation: Apple Keychain Services)(Citation: Elcomsoft Decrypt Keychain) ",https://attack.mitre.org/techniques/T1634/001,01 April 2022,05 April 2022,1.0,,Credential Access,"Mobile security products can potentially detect jailbroken devices. Application vetting services may be able to detect known privilege escalation exploits contained within applications, as well as searching application packages for strings that correlate to known password store locations.",iOS,Post-Adversary Device Access,AUT-11,"(Citation: Google Project Zero Insomnia),"
T1417.001,Keylogging,"Adversaries may log user keystrokes to intercept credentials or other information from the user as the user types them.

Some methods of keylogging include:

* Masquerading as a legitimate third-party keyboard to record user keystrokes.(Citation: Zeltser-Keyboard) On both Android and iOS, users must explicitly authorize the use of third-party keyboard apps. Users should be advised to use extreme caution before granting this authorization when it is requested.
* Abusing accessibility features. On Android, adversaries may abuse accessibility features to record keystrokes by registering an `AccessibilityService` class, overriding the `onAccessibilityEvent` method, and listening for the `AccessibilityEvent.TYPE_VIEW_TEXT_CHANGED` event type. The event object passed into the function will contain the data that the user typed. 
*Additional methods of keylogging may be possible if root access is available. 
",https://attack.mitre.org/techniques/T1417/001,05 April 2022,19 April 2022,1.0,,"Collection, Credential Access","On Android, users can view and manage which applications have third-party keyboard access through the device settings in System -> Languages & input -> Virtual keyboard. On iOS, users can view and manage which applications have third-party keyboard access through the device settings in General -> Keyboard. 

Application vetting services can look for applications requesting the `android.permission.BIND_ACCESSIBILITY_SERVICE` permission in a service declaration. On Android, users can view and manage which applications can use accessibility services through the device settings in Accessibility. The exact device settings menu locations may vary between operating system versions.","Android, iOS",Post-Adversary Device Access,AUT-13,"(Citation: Threat Fabric Cerberus),(Citation: FlexiSpy-Features),(Citation: Talos Gustuff Apr 2019),(Citation: Cofense Anubis),(Citation: Threat Fabric Exobot),(Citation: Lookout-Monokle),(Citation: Cybereason EventBot),(Citation: SecureList BusyGasper),(Citation: BlackBerry Bahamut),(Citation: Samsung Keyboards)"
T1430,Location Tracking,"Adversaries may track a device’s physical location through use of standard operating system APIs via malicious or exploited applications on the compromised device. 

 

On Android, applications holding the `ACCESS_COAURSE_LOCATION` or `ACCESS_FINE_LOCATION` permissions provide access to the device’s physical location. On Android 10 and up, declaration of the `ACCESS_BACKGROUND_LOCATION` permission in an application’s manifest will allow applications to request location access even when the application is running in the background.(Citation: Android Request Location Permissions) Some adversaries have utilized integration of Baidu map services to retrieve geographical location once the location access permissions had been obtained.(Citation: PaloAlto-SpyDealer)(Citation: Palo Alto HenBox) 

 

On iOS, applications must include the `NSLocationWhenInUseUsageDescription`, `NSLocationAlwaysAndWhenInUseUsageDescription`, and/or `NSLocationAlwaysUsageDescription` keys in their `Info.plist` file depending on the extent of requested access to location information.(Citation: Apple Requesting Authorization for Location Services) On iOS 8.0 and up, applications call `requestWhenInUseAuthorization()` to request access to location information when the application is in use or `requestAlwaysAuthorization()` to request access to location information regardless of whether the application is in use. With elevated privileges, an adversary may be able to access location data without explicit user consent with the `com.apple.locationd.preauthorized` entitlement key.(Citation: Google Project Zero Insomnia)",https://attack.mitre.org/techniques/T1430,25 October 2017,01 April 2022,1.1,,"Collection, Discovery","Android applications requesting the `ACCESS_COARSE_LOCATION`, `ACCESS_FINE_LOCATION`, or `ACCESS_BACKGROUND_LOCATION` permissions and iOS applications including the `NSLocationWhenInUseUsageDescription`, `NSLocationAlwaysAndWhenInUseUsageDescription`, and/or `NSLocationAlwaysUsageDescription` keys in their `Info.plist` file could be scrutinized during the application vetting process. 

 

In both Android (6.0 and up) and iOS, users can view which applications have the permission to access the device location through the device settings screen and revoke permissions as necessary.  ","Android, iOS",Post-Adversary Device Access,APP-24,"(Citation: Threat Fabric Cerberus),(Citation: CYBERWARCON CHEMISTGAMES),(Citation: Talos GPlayed),(Citation: Cofense Anubis),(Citation: TrendMicro-RCSAndroid),(Citation: SecureList BusyGasper),(Citation: PaloAlto-SpyDealer),(Citation: Zscaler-SpyNote),(Citation: Lookout ViperRAT),(Citation: Lookout-EnterpriseApps),(Citation: Bitdefender Mandrake),(Citation: Zscaler TikTok Spyware),(Citation: SecureList - ViceLeaker 2019),(Citation: Lookout Uyghur Campaign),(Citation: CheckPoint-Charger),(Citation: Kaspersky-Skygofree),(Citation: Google Project Zero Insomnia),(Citation: Lookout-Monokle),(Citation: Kaspersky-WUC),(Citation: Lookout eSurv),(Citation: NYTimes-BackDoor),(Citation: CyberMerchants-FlexiSpy),(Citation: TrendMicro Coronavirus Updates),(Citation: SWB Exodus March 2019),(Citation: Lookout Desert Scorpion),(Citation: Bitdefender - Triout 2018),(Citation: Lookout-Pegasus),(Citation: Lookout-StealthMango),(Citation: CrowdStrike-Android),(Citation: Lookout FrozenCell),(Citation: Symantec GoldenCup),(Citation: Palo Alto HenBox),(Citation: Lookout Dark Caracal Jan 2018),(Citation: BlackBerry Bahamut),(Citation: Trend Micro Bouncing Golf 2019),(Citation: CSRIC5-WG10-FinalReport)"
T1461,Lockscreen Bypass,"An adversary with physical access to a mobile device may seek to bypass the device’s lockscreen. Several methods exist to accomplish this, including:

* Biometric spoofing: If biometric authentication is used, an adversary could attempt to spoof a mobile device’s biometric authentication mechanism. Both iOS and Android partly mitigate this attack by requiring the device’s passcode rather than biometrics to unlock the device after every device restart, and after a set or random amount of time.(Citation: SRLabs-Fingerprint)(Citation: TheSun-FaceID)
* Unlock code bypass: An adversaries could attempt to brute-force or otherwise guess the lockscreen passcode (typically a PIN or password), including physically observing (“shoulder surfing”) the device owner’s use of the lockscreen passcode. Mobile OS vendors partly mitigate this by implementing incremental backoff timers after a set number of failed unlock attempts, as well as a configurable full device wipe after several failed unlock attempts.
* Vulnerability exploit: Techniques have been periodically demonstrated that exploit mobile devices to bypass the lockscreen. The vulnerabilities are generally patched by the device or OS vendor once disclosed.(Citation: Wired-AndroidBypass)(Citation: Kaspersky-iOSBypass)
",https://attack.mitre.org/techniques/T1461,25 October 2017,19 April 2022,1.2,,Initial Access,Users can see if someone is watching them type in their device passcode.,"Android, iOS",Post-Adversary Device Access,,","
T1575,Native API,"Adversaries may use Android’s Native Development Kit (NDK) to write native functions that can achieve execution of binaries or functions. Like system calls on a traditional desktop operating system, native code achieves execution on a lower level than normal Android SDK calls.

The NDK allows developers to write native code in C or C++ that is compiled directly to machine code, avoiding all intermediate languages and steps in compilation that higher level languages, like Java, typically have. The Java Native Interface (JNI) is the component that allows Java functions in the Android app to call functions in a native library.(Citation: Google NDK Getting Started)

Adversaries may also choose to use native functions to execute malicious code since native actions are typically much more difficult to analyze than standard, non-native behaviors.(Citation: MITRE App Vetting Effectiveness)",https://attack.mitre.org/techniques/T1575,28 April 2020,08 April 2022,2.0,,"Defense Evasion, Execution",This is abuse of standard OS-level APIs and are therefore typically undetectable to the end user.,Android,Post-Adversary Device Access,,"(Citation: Securelist Asacub),(Citation: Lookout Uyghur Campaign),(Citation: WhiteOps TERRACOTTA),(Citation: Google Bread),(Citation: CYBERWARCON CHEMISTGAMES),(Citation: Palo Alto HenBox),"
T1464,Network Denial of Service,"Adversaries may perform Network Denial of Service (DoS) attacks to degrade or block the availability of targeted resources to users. Network DoS can be performed by exhausting the network bandwidth that services rely on, or by jamming the signal going to or coming from devices. 

A Network DoS will occur when an adversary is able to jam radio signals (e.g. Wi-Fi, cellular, GPS) around a device to prevent it from communicating. For example, to jam cellular signal, an adversary may use a handheld signal jammer, which jam devices within the jammer’s operational range.(Citation: NIST-SP800187) 

Usage of cellular jamming has been documented in several arrests reported in the news.(Citation: CNET-Celljammer)(Citation: NYTimes-Celljam)(Citation: Digitaltrends-Celljam)(Citation: Arstechnica-Celljam)",https://attack.mitre.org/techniques/T1464,25 October 2017,06 April 2022,1.2,,Impact,Unexpected loss of radio signal could indicate that a device is being actively jammed.,"Android, iOS",Post-Adversary Device Access,CEL-7,","
T1423,Network Service Scanning,"Adversaries may attempt to get a listing of services running on remote hosts, including those that may be vulnerable to remote software exploitation. Methods to acquire this information include port scans and vulnerability scans from the mobile device. This technique may take advantage of the mobile device's access to an internal enterprise network either through local connectivity or through a Virtual Private Network (VPN).",https://attack.mitre.org/techniques/T1423,25 October 2017,11 April 2022,1.1,,Discovery,"Network service scanning can be difficult to detect, and therefore enterprises may be better served focusing on detection at other stages of adversarial behavior.","Android, iOS",Post-Adversary Device Access,,","
T1509,Non-Standard Port,"Adversaries may generate network traffic using a protocol and port paring that are typically not associated. For example, HTTPS over port 8088 or port 587 as opposed to the traditional port 443. Adversaries may make changes to the standard port used by a protocol to bypass filtering or muddle analysis/parsing of network data.",https://attack.mitre.org/techniques/T1509,01 August 2019,06 April 2022,2.0,,Command and Control,"Application vetting reports may show network communications performed by the application, including hosts, ports, protocols, and URLs. Further detection would most likely be at the enterprise level, through packet and/or netflow inspection. Many properly configured firewalls may also naturally block command and control traffic over non-standard ports.","Android, iOS",Post-Adversary Device Access,,"(Citation: FortiGuard-FlexiSpy),(Citation: SWB Exodus March 2019),(Citation: Volexity Insomnia),(Citation: CheckPoint Cerberus),(Citation: Sophos Red Alert 2.0),(Citation: Bitdefender Mandrake),"
T1406,Obfuscated Files or Information,"Adversaries may attempt to make a payload or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the device or in transit. This is common behavior that can be used across different platforms and the network to evade defenses. 
 
Payloads may be compressed, archived, or encrypted in order to avoid detection. These payloads may be used during Initial Access or later to mitigate detection. Portions of files can also be encoded to hide the plaintext strings that would otherwise help defenders with discovery. Payloads may also be split into separate, seemingly benign files that only reveal malicious functionality when reassembled.(Citation: Microsoft MalLockerB) ",https://attack.mitre.org/techniques/T1406,25 October 2017,06 April 2022,3.0,,Defense Evasion,"Dynamic analysis, when used in application vetting, may in some cases be able to identify malicious code in obfuscated or encrypted form by detecting the code at execution time (after it is deobfuscated or decrypted). Some application vetting techniques apply reputation analysis of the application developer and can alert to potentially suspicious applications without actual examination of application code.","Android, iOS",Post-Adversary Device Access,APP-21,"(Citation: ThreatFabric Ginp),(Citation: Threat Fabric Cerberus),(Citation: Talos-WolfRAT),(Citation: Microsoft MalLockerB),(Citation: CYBERWARCON CHEMISTGAMES),(Citation: Talos GPlayed),(Citation: Talos Gustuff Apr 2019),(Citation: securelist rotexy 2018),(Citation: Bitdefender Mandrake),(Citation: Cybereason FakeSpy),(Citation: Securelist Asacub),(Citation: Lookout Uyghur Campaign),(Citation: TrendMicro-Obad),(Citation: WhiteOps TERRACOTTA),(Citation: PaloAlto-WireLurker),(Citation: CheckPoint-Charger),(Citation: Lookout-BrainTest),(Citation: Volexity Insomnia),(Citation: WeLiveSecurity AdDisplayAshas),(Citation: Lookout-Monokle),(Citation: Cybereason EventBot),(Citation: SecurityIntelligence TrickMo),(Citation: TrendMicro-XLoader),(Citation: FortiGuard-FlexiSpy),(Citation: Google Bread),(Citation: Palo Alto HenBox),(Citation: SecureList DVMap June 2017),(Citation: Lookout Dark Caracal Jan 2018),(Citation: Sophos Red Alert 2.0),(Citation: Google Security Zen),(Citation: Check Point-Joker),(Citation: BlackBerry Bahamut),(Citation: Trend Micro Bouncing Golf 2019),"
T1481.003,One-Way Communication,"Adversaries may use an existing, legitimate external Web service channel as a means for sending commands to a compromised system without receiving return output. Compromised systems may leverage popular websites and social media to host command and control (C2) instructions. Those infected systems may opt to send the output from those commands back over a different C2 channel, including to another distinct Web service. Alternatively, compromised systems may return no output at all in cases where adversaries want to send instructions to systems and do not want a response. 

 

Popular websites and social media, acting as a mechanism for C2, may give a significant amount of cover. This is due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection. ",https://attack.mitre.org/techniques/T1481/003,06 April 2022,06 April 2022,1.0,,Command and Control,"Application vetting services may provide a list of connections made or received by an application, or a list of domains contacted by the application.","Android, iOS",Post-Adversary Device Access,,"(Citation: ESET-Twitoor),"
T1644,Out of Band Data,"Adversaries may communicate with compromised devices using out of band data streams. This could be done for a variety of reasons, including evading network traffic monitoring, as a backup method of command and control, or for data exfiltration if the device is not connected to any Internet-providing networks (i.e. cellular or Wi-Fi). Several out of band data streams exist, such as SMS messages, NFC, and Bluetooth. 

 

On Android, applications can read push notifications to capture content from SMS messages, or other out of band data streams. This requires that the user manually grant notification access to the application via the settings menu. However, the application could launch an Intent to take the user directly there. 

 

On iOS, there is no way to programmatically read push notifications. ",https://attack.mitre.org/techniques/T1644,06 April 2022,29 April 2022,2.0,,Command and Control,"If a user sees a notification with text they do not recognize, they should review their list of installed applications.","Android, iOS",Post-Adversary Device Access,,"(Citation: Lookout Uyghur Campaign),(Citation: Lookout-StealthMango),(Citation: securelist rotexy 2018),(Citation: Talos Gustuff Apr 2019),(Citation: Kaspersky-Skygofree),(Citation: Lookout Desert Scorpion),(Citation: Lookout-Monokle),(Citation: Lookout-PegasusAndroid),(Citation: TrendMicro-RCSAndroid),(Citation: Kaspersky-WUC),(Citation: SecureList BusyGasper),(Citation: PaloAlto-SpyDealer),(Citation: SecurityIntelligence TrickMo),(Citation: Lookout-Pegasus),"
T1629.001,Prevent Application Removal,"Adversaries may abuse the Android device administration API to prevent the user from uninstalling a target application. In earlier versions of Android, device administrator applications needed their administration capabilities explicitly deactivated by the user before the application could be uninstalled. This was later updated so the user could deactivate and uninstall the administrator application in one step.

Adversaries may also abuse the device accessibility APIs to prevent removal. This set of APIs allows the application to perform certain actions on behalf of the user and programmatically determine what is being shown on the screen. The malicious application could monitor the device screen for certain modals (e.g., the confirmation modal to uninstall an application) and inject screen input or a back button tap to close the modal.",https://attack.mitre.org/techniques/T1629/001,01 April 2022,05 April 2022,1.0,,Defense Evasion,Users can view a list of device administrators and applications that have registered accessibility services in device settings. Users can typically visually see when an action happens that they did not initiate and can subsequently review installed applications for any out of place or unknown ones. Applications that register an accessibility service or request device administrator permissions should be scrutinized further for malicious behavior.,Android,Post-Adversary Device Access,APP-22,"(Citation: TrendMicro-Obad),(Citation: Bitdefender Mandrake),"
T1424,Process Discovery,"Adversaries may attempt to get information about running processes on a device. Information obtained could be used to gain an understanding of common software/applications running on devices within a network. Adversaries may use the information from [Process Discovery](https://attack.mitre.org/techniques/T1424) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions. 

 

Recent Android security enhancements have made it more difficult to obtain a list of running processes. On Android 7 and later, there is no way for an application to obtain the process list without abusing elevated privileges. This is due to the Android kernel utilizing the `hidepid` mount feature. Prior to Android 7, applications could utilize the `ps` command or examine the `/proc` directory on the device.(Citation: Android-SELinuxChanges) 

 

In iOS, applications have previously been able to use the `sysctl` command to obtain a list of running processes. This functionality has been removed in later iOS versions. ",https://attack.mitre.org/techniques/T1424,25 October 2017,30 March 2022,2.0,,Discovery,"Mobile security products can typically detect rooted devices, which is an indication that Process Discovery is possible. Application vetting could potentially detect when applications attempt to abuse root access or root the system itself. Further, application vetting services could look for attempted usage of legacy process discovery mechanisms, such as the usage of `ps` or inspection of the `/proc` directory.","Android, iOS",Post-Adversary Device Access,,"(Citation: Talos-WolfRAT),(Citation: securelist rotexy 2018),(Citation: Zimperium z9),(Citation: Palo Alto HenBox),(Citation: CheckPoint Agent Smith),(Citation: Trend Micro Bouncing Golf 2019),"
T1631,Process Injection,"Adversaries may inject code into processes in order to evade process-based defenses or even elevate privileges. Process injection is a method of executing arbitrary code in the address space of a separate live process. Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via process injection may also evade detection from security products since the execution is masked under a legitimate process. 

Both Android and iOS have no legitimate way to achieve process injection. The only way this is possible is by abusing existing root access or exploiting a vulnerability.",https://attack.mitre.org/techniques/T1631,30 March 2022,05 April 2022,1.0,,"Defense Evasion, Privilege Escalation",Application vetting services could look for misuse of dynamic libraries.,"Android, iOS",Post-Adversary Device Access,,","
T1636,Protected User Data,"Adversaries may utilize standard operating system APIs to collect data from permission-backed data stores on a device, such as the calendar or contact list. These permissions need to be declared ahead of time. On Android, they must be included in the application’s manifest. On iOS, they must be included in the application’s `Info.plist` file.  

 

In almost all cases, the user is required to grant access to the data store that the application is trying to access. In recent OS versions, vendors have introduced additional privacy controls for users, such as the ability to grant permission to an application only while the application is being actively used by the user. 

 

If the device has been jailbroken or rooted, an adversary may be able to access [Protected User Data](https://attack.mitre.org/techniques/T1636) without the user’s knowledge or approval. ",https://attack.mitre.org/techniques/T1636,01 April 2022,11 April 2022,1.0,,Collection,"Users can view permissions granted to an application in device settings. Application vetting services typically flag permissions requested by an application, which can be reviewed by an administrator. Certain dangerous permissions, such as `RECEIVE_SMS`, could receive additional scrutiny.","Android, iOS",Post-Adversary Device Access,APP-13,","
T1604,Proxy Through Victim,"Adversaries may use a compromised device as a proxy server to the Internet. By utilizing a proxy, adversaries hide the true IP address of their C2 server and associated infrastructure from the destination of the network traffic. This masquerades an adversary’s traffic as legitimate traffic originating from the compromised device, which can evade IP-based restrictions and alerts on certain services, such as bank accounts and social media websites.(Citation: Threat Fabric Exobot)

The most common type of proxy is a SOCKS proxy. It can typically be implemented using standard OS-level APIs and 3rd party libraries with no indication to the user. On Android, adversaries can use the `Proxy` API to programmatically establish a SOCKS proxy connection, or lower-level APIs to interact directly with raw sockets.",https://attack.mitre.org/techniques/T1604,30 November 2020,24 October 2022,1.0,,Defense Evasion,"Enterprises may be able to detect anomalous traffic originating from mobile devices, which could indicate compromise.",Android,Post-Adversary Device Access,,"(Citation: Threat Fabric Exobot),"
T1631.001,Ptrace System Calls,"Adversaries may inject malicious code into processes via ptrace (process trace) system calls in order to evade process-based defenses as well as possibly elevate privileges. Ptrace system call injection is a method of executing arbitrary code in the address space of a separate live process.  

Ptrace system call injection involves attaching to and modifying a running process. The ptrace system call enables a debugging process to observe and control another process (and each individual thread), including changing memory and register values.(Citation: PTRACE man) Ptrace system call injection is commonly performed by writing arbitrary code into a running process (e.g., by using `malloc`) then invoking that memory with `PTRACE_SETREGS` to set the register containing the next instruction to execute. Ptrace system call injection can also be done with `PTRACE_POKETEXT`/`PTRACE_POKEDATA`, which copy data to a specific address in the target process's memory (e.g., the current address of the next instruction).(Citation: PTRACE man)(Citation: Medium Ptrace JUL 2018)  

Ptrace system call injection may not be possible when targeting processes with high-privileges, and on some systems those that are non-child processes.(Citation: BH Linux Inject)  

Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via ptrace system call injection may also evade detection from security products since the execution is masked under a legitimate process.",https://attack.mitre.org/techniques/T1631/001,30 March 2022,05 April 2022,1.0,,"Defense Evasion, Privilege Escalation",Application vetting services could look for misuse of dynamic libraries.,"Android, iOS",Post-Adversary Device Access,,"(Citation: Google Triada June 2019),(Citation: Google Security Zen),(Citation: Google Project Zero Insomnia),(Citation: Kaspersky Triada March 2016),"
T1430.001,Remote Device Management Services,An adversary may use access to cloud services (e.g. Google's Android Device Manager or Apple iCloud's Find my iPhone) or to an enterprise mobility management (EMM)/mobile device management (MDM) server console to track the location of mobile devices managed by the service.(Citation: Krebs-Location) ,https://attack.mitre.org/techniques/T1430/001,05 April 2022,21 October 2022,1.0,,"Collection, Discovery","Google sends a notification to the device when Android Device Manager is used to locate it. Additionally, Google provides the ability for users to view their general account activity and alerts users when their credentials have been used on a new device. Apple iCloud also provides notifications to users of account activity such as when credentials have been used. ","Android, iOS",Post-Adversary Device Access,ECO-5,","
T1458,Replication Through Removable Media,"Adversaries may move onto devices by exploiting or copying malware to devices connected via USB. In the case of Lateral Movement, adversaries may utilize the physical connection of a device to a compromised or malicious charging station or PC to bypass application store requirements and install malicious applications directly.(Citation: Lau-Mactans) In the case of Initial Access, adversaries may attempt to exploit the device via the connection to gain access to data stored on the device.(Citation: Krebs-JuiceJacking) Examples of this include: 
 
* Exploiting insecure bootloaders in a Nexus 6 or 6P device over USB and gaining the ability to perform actions including intercepting phone calls, intercepting network traffic, and obtaining the device physical location.(Citation: IBM-NexusUSB) 
* Exploiting weakly-enforced security boundaries in Android devices such as the Google Pixel 2 over USB.(Citation: GoogleProjectZero-OATmeal) 
* Products from Cellebrite and Grayshift purportedly that can exploit some iOS devices using physical access to the data port to unlock the passcode.(Citation: Computerworld-iPhoneCracking) ",https://attack.mitre.org/techniques/T1458,25 October 2017,08 April 2022,2.0,,"Initial Access, Lateral Movement",,"Android, iOS",Post-Adversary Device Access,PHY-1,"(Citation: PaloAlto-WireLurker),(Citation: PaloAlto-DualToy),(Citation: Elcomsoft-iOSRestricted)"
T1582,SMS Control,"Adversaries may delete, alter, or send SMS messages without user authorization. This could be used to hide C2 SMS messages, spread malware, or various external effects.

This can be accomplished by requesting the `RECEIVE_SMS` or `SEND_SMS` permissions depending on what the malware is attempting to do. If the app is set as the default SMS handler on the device, the `SMS_DELIVER` broadcast intent can be registered, which allows the app to write to the SMS content provider. The content provider directly modifies the messaging database on the device, which could allow malicious applications with this ability to insert, modify, or delete arbitrary messages on the device.(Citation: SMS KitKat)(Citation: Android SmsProvider)",https://attack.mitre.org/techniques/T1582,11 September 2020,24 October 2022,1.0,,Impact,Users can view the default SMS handler in system settings.,Android,Post-Adversary Device Access,APP-16,"(Citation: ThreatFabric Ginp),(Citation: Threat Fabric Cerberus),(Citation: Talos-WolfRAT),(Citation: securelist rotexy 2018),(Citation: Talos GPlayed),(Citation: Cofense Anubis),(Citation: SecureList BusyGasper),(Citation: Zscaler TikTok Spyware),(Citation: Cybereason FakeSpy),(Citation: Bitdefender Mandrake),(Citation: Securelist Asacub),(Citation: Lookout Uyghur Campaign),(Citation: WhiteOps TERRACOTTA),(Citation: Threat Fabric Exobot),(Citation: Lookout-Dendroid),(Citation: TrendMicro Coronavirus Updates),(Citation: Lookout Desert Scorpion),(Citation: SecurityIntelligence TrickMo),(Citation: Lookout-StealthMango),(Citation: Sophos Red Alert 2.0),(Citation: SMS KitKat)"
T1636.004,SMS Messages,"Adversaries may utilize standard operating system APIs to gather SMS messages. On Android, this can be accomplished using the SMS Content Provider. iOS provides no standard API to access SMS messages. 

If the device has been jailbroken or rooted, an adversary may be able to access [SMS Messages](https://attack.mitre.org/techniques/T1636/004) without the user’s knowledge or approval. ",https://attack.mitre.org/techniques/T1636/004,01 April 2022,11 April 2022,1.0,,Collection,"On Android, the user can manage which applications have permission to access SMS messages through the device settings screen, revoking the permission if necessary. Application vetting services could look for `android.permission.READ_SMS` in an Android application’s manifest. Most applications do not need access to SMS messages, so extra scrutiny could be applied to those that request it. ","Android, iOS",,APP-13,"(Citation: ThreatFabric Ginp),(Citation: Threat Fabric Cerberus),(Citation: FlexiSpy-Features),(Citation: Talos-WolfRAT),(Citation: securelist rotexy 2018),(Citation: Talos Gustuff Apr 2019),(Citation: Talos GPlayed),(Citation: FireEye-RuMMS),(Citation: TrendMicro-RCSAndroid),(Citation: SecureList BusyGasper),(Citation: PaloAlto-SpyDealer),(Citation: Zscaler-SpyNote),(Citation: Lookout ViperRAT),(Citation: Lookout-EnterpriseApps),(Citation: Cybereason FakeSpy),(Citation: Bitdefender Mandrake),(Citation: Securelist Asacub),(Citation: Lookout Uyghur Campaign),(Citation: Zscaler TikTok Spyware),(Citation: SecureList - ViceLeaker 2019),(Citation: Kaspersky Triada March 2016),(Citation: Zscaler-SuperMarioRun),(Citation: Kaspersky Riltok June 2019),(Citation: Google Project Zero Insomnia),(Citation: Threat Fabric Exobot),(Citation: Cybereason EventBot),(Citation: Kaspersky-WUC),(Citation: Lookout-Dendroid),(Citation: NYTimes-BackDoor),(Citation: CyberMerchants-FlexiSpy),(Citation: TrendMicro Coronavirus Updates),(Citation: SWB Exodus March 2019),(Citation: Lookout Desert Scorpion),(Citation: SecurityIntelligence TrickMo),(Citation: Tripwire-MazarBOT),(Citation: Lookout-Pegasus),(Citation: TrendMicro-XLoader),(Citation: Google Bread),(Citation: Lookout-StealthMango),(Citation: PaloAlto-Xbot),(Citation: Lookout FrozenCell),(Citation: Symantec GoldenCup),(Citation: Palo Alto HenBox),(Citation: Lookout Dark Caracal Jan 2018),(Citation: Sophos Red Alert 2.0),(Citation: Cylance Dust Storm),(Citation: BlackBerry Bahamut),(Citation: Trend Micro Bouncing Golf 2019),"
T1603,Scheduled Task/Job,"Adversaries may abuse task scheduling functionality to facilitate initial or recurring execution of malicious code. On Android and iOS, APIs and libraries exist to facilitate scheduling tasks to execute at a specified date, time, or interval.

On Android, the `WorkManager` API allows asynchronous tasks to be scheduled with the system. `WorkManager` was introduced to unify task scheduling on Android, using `JobScheduler`, `GcmNetworkManager`, and `AlarmManager` internally. `WorkManager` offers a lot of flexibility for scheduling, including periodically, one time, or constraint-based (e.g. only when the device is charging).(Citation: Android WorkManager)

On iOS, the `NSBackgroundActivityScheduler` API allows asynchronous tasks to be scheduled with the system. The tasks can be scheduled to be repeating or non-repeating, however, the system chooses when the tasks will be executed. The app can choose the interval for repeating tasks, or the delay between scheduling and execution for one-time tasks.(Citation: Apple NSBackgroundActivityScheduler)",https://attack.mitre.org/techniques/T1603,04 November 2020,24 October 2022,1.0,"Lorin Wu, Trend Micro","Execution, Persistence","Scheduling tasks/jobs can be difficult to detect, and therefore enterprises may be better served focusing on detection at other stages of adversarial behavior.","Android, iOS",Post-Adversary Device Access,,"(Citation: WhiteOps TERRACOTTA),(Citation: Zscaler TikTok Spyware),(Citation: Talos GPlayed),"
T1513,Screen Capture,"Adversaries may use screen capture to collect additional information about a target device, such as applications running in the foreground, user data, credentials, or other sensitive information. Applications running in the background can capture screenshots or videos of another application running in the foreground by using the Android `MediaProjectionManager` (generally requires the device user to grant consent).(Citation: Fortinet screencap July 2019)(Citation: Android ScreenCap1 2019) Background applications can also use Android accessibility services to capture screen contents being displayed by a foreground application.(Citation: Lookout-Monokle) An adversary with root access or Android Debug Bridge (adb) access could call the Android `screencap` or `screenrecord` commands.(Citation: Android ScreenCap2 2019)(Citation: Trend Micro ScreenCap July 2015) ",https://attack.mitre.org/techniques/T1513,08 August 2019,01 April 2022,1.2,,Collection,"The user can view a list of apps with accessibility service privileges in the device settings. Application vetting services can look for the use of the Android `MediaProjectionManager` class, applying extra scrutiny to applications that use the class.",Android,Post-Adversary Device Access,APP-40,"(Citation: ThreatFabric Ginp),(Citation: Lookout Uyghur Campaign),(Citation: Talos-WolfRAT),(Citation: FlexiSpy-Features),(Citation: Zscaler TikTok Spyware),(Citation: SWB Exodus March 2019),(Citation: Cofense Anubis),(Citation: Lookout-Monokle),(Citation: Cybereason EventBot),(Citation: SecurityIntelligence TrickMo),(Citation: ESET DEFENSOR ID),(Citation: SecureList BusyGasper),(Citation: PaloAlto-SpyDealer),(Citation: Bitdefender Mandrake),(Citation: Trend Micro Bouncing Golf 2019),(Citation: Nightwatch screencap April 2016)"
T1418.001,Security Software Discovery,"Adversaries may attempt to get a listing of security applications and configurations that are installed on a device. This may include things such as mobile security products. Adversaries may use the information from [Security Software Discovery](https://attack.mitre.org/techniques/T1418/001) during automated discovery to shape follow-on behaviors, including whether or not to fully infect the target and/or attempt specific actions. ",https://attack.mitre.org/techniques/T1418/001,31 March 2022,11 April 2022,1.0,,Discovery,"Application vetting services could look for the Android permission `android.permission.QUERY_ALL_PACKAGES`, and apply extra scrutiny to applications that request it. On iOS, application vetting services could look for usage of the private API `LSApplicationWorkspace` and apply extra scrutiny to applications that employ it.","Android, iOS",Post-Adversary Device Access,APP-12,"(Citation: Talos Gustuff Apr 2019),(Citation: Threat Fabric Exobot),(Citation: Android Package Visibility)"
T1418,Software Discovery,"Adversaries may attempt to get a listing of applications that are installed on a device. Adversaries may use the information from [Software Discovery](https://attack.mitre.org/techniques/T1418) during automated discovery to shape follow-on behaviors, including whether or not to fully infect the target and/or attempts specific actions. 

 

Adversaries may attempt to enumerate applications for a variety of reasons, such as figuring out what security measures are present or to identify the presence of target applications. ",https://attack.mitre.org/techniques/T1418,25 October 2017,30 March 2022,2.0,,Discovery,"Application vetting services could look for the Android permission `android.permission.QUERY_ALL_PACKAGES`, and apply extra scrutiny to applications that request it. On iOS, application vetting services could look for usage of the private API `LSApplicationWorkspace` and apply extra scrutiny to applications that employ it.","Android, iOS",Post-Adversary Device Access,APP-12,"(Citation: ThreatFabric Ginp),(Citation: Threat Fabric Cerberus),(Citation: FlexiSpy-Features),(Citation: Talos-WolfRAT),(Citation: securelist rotexy 2018),(Citation: Talos GPlayed),(Citation: Cofense Anubis),(Citation: ESET DEFENSOR ID),(Citation: CheckPoint Agent Smith),(Citation: Bitdefender Mandrake),(Citation: Cybereason FakeSpy),(Citation: Zscaler TikTok Spyware),(Citation: SecureList - ViceLeaker 2019),(Citation: Lookout Uyghur Campaign),(Citation: WhiteOps TERRACOTTA),(Citation: Kaspersky Riltok June 2019),(Citation: Google Project Zero Insomnia),(Citation: WeLiveSecurity AdDisplayAshas),(Citation: Lookout-Monokle),(Citation: Cybereason EventBot),(Citation: SWB Exodus March 2019),(Citation: Lookout Desert Scorpion),(Citation: Lookout-PegasusAndroid),(Citation: SecurityIntelligence TrickMo),(Citation: Google Triada June 2019),(Citation: Lookout-StealthMango),(Citation: Symantec GoldenCup),(Citation: Palo Alto HenBox),(Citation: Lookout Dark Caracal Jan 2018),(Citation: Sophos Red Alert 2.0),(Citation: Trend Micro Bouncing Golf 2019),(Citation: Android Package Visibility)"
T1406.002,Software Packing,"Adversaries may perform software packing to conceal their code. Software packing is a method of compressing or encrypting an executable. Packing an executable changes the file signature in an attempt to avoid signature-based detection. Most decompression techniques decompress the executable code in memory. 

Utilities used to perform software packing are called packers. An example packer is FTT. A more comprehensive list of known packers is available, but adversaries may create their own packing techniques that do not leave the same artifacts as well-known packers to evade defenses.",https://attack.mitre.org/techniques/T1406/002,30 March 2022,21 April 2022,1.0,,Defense Evasion,"Application vetting services could look for known software packers or artifacts of packing techniques. Packing is not a definitive indicator of malicious activity, because as legitimate software may use packing techniques to reduce binary size or to protect proprietary code.","Android, iOS",Post-Adversary Device Access,,"(Citation: Google Bread),(Citation: Talos Gustuff Apr 2019),"
T1635,Steal Application Access Token,"Adversaries can steal user application access tokens as a means of acquiring credentials to access remote systems and resources. This can occur through social engineering or URI hijacking and typically requires user action to grant access, such as through a system “Open With” dialogue.  

Application access tokens are used to make authorized API requests on behalf of a user and are commonly used as a way to access resources in cloud-based applications and software-as-a-service (SaaS).(Citation: Auth0 - Why You Should Always Use Access Tokens to Secure APIs Sept 2019) OAuth is one commonly implemented framework used to issue tokens to users for access to systems. An application desiring access to cloud-based services or protected APIs can gain entry through OAuth 2.0 using a variety of authorization protocols. An example of a commonly-used sequence is Microsoft's Authorization Code Grant flow.(Citation: Microsoft Identity Platform Protocols May 2019)(Citation: Microsoft - OAuth Code Authorization flow - June 2019) An OAuth access token enables a third-party application to interact with resources containing user data in the ways requested without requiring user credentials.",https://attack.mitre.org/techniques/T1635,01 April 2022,05 April 2022,1.0,,Credential Access,"On Android, users may be presented with a popup to select the appropriate application to open a URI in. If the user sees an application they do not recognize, they can remove it. When vetting applications for potential security weaknesses, the vetting process could look for insecure use of Intents. Developers should be encouraged to use techniques to ensure that the intent can only be sent to an appropriate destination (e.g., use explicit rather than implicit intents, permission checking, checking of the destination app's signing certificate, or utilizing the App Links feature). For mobile applications using OAuth, encourage use of best practice.(Citation: IETF-OAuthNativeApps)(Citation: Android-AppLinks)","Android, iOS",Post-Adversary Device Access,,",(Citation: Trend Micro iOS URL Hijacking),(Citation: Android App Links),(Citation: IETF-PKCE),(Citation: iOS Universal Links)"
T1406.001,Steganography,"Adversaries may use steganography techniques in order to prevent the detection of hidden information. Steganographic techniques can be used to hide data in digital media such as images, audio tracks, video clips, or text files.",https://attack.mitre.org/techniques/T1406/001,30 March 2022,21 April 2022,1.0,,Defense Evasion,Detection of steganography is difficult unless detectable artifacts with a known signature are left behind by the obfuscation process. Look for strings are other signatures left in system artifacts related to decoding steganography.,Android,Post-Adversary Device Access,,"(Citation: CheckPoint Agent Smith),"
T1409,Stored Application Data,"Adversaries may try to access and collect application data resident on the device. Adversaries often target popular applications, such as Facebook, WeChat, and Gmail.(Citation: SWB Exodus March 2019) 

 

Due to mobile OS sandboxing, this technique is only possible in three scenarios: 

 

* An application stores files in unprotected external storage 
* An application stores files in its internal storage directory with insecure permissions (e.g. 777) 
* The adversary gains root permissions on the device ",https://attack.mitre.org/techniques/T1409,25 October 2017,11 April 2022,3.0,,Collection,"Application vetting services could detect when applications store data insecurely, for example, in unprotected external storage.","Android, iOS",Post-Adversary Device Access,AUT-0,"(Citation: Lookout Uyghur Campaign),(Citation: FortiGuard-FlexiSpy),(Citation: Lookout-StealthMango),(Citation: Lookout FrozenCell),(Citation: SWB Exodus March 2019),(Citation: Kaspersky-Skygofree),(Citation: Lookout Dark Caracal Jan 2018),(Citation: Lookout Desert Scorpion),(Citation: Lookout-PegasusAndroid),(Citation: TrendMicro-RCSAndroid),(Citation: SecureList BusyGasper),(Citation: PaloAlto-SpyDealer),(Citation: Bitdefender Mandrake),(Citation: Cybereason FakeSpy),(Citation: Lookout-Pegasus),"
T1632,Subvert Trust Controls,Adversaries may undermine security controls that will either warn users of untrusted activity or prevent execution of untrusted applications. Operating systems and security products may contain mechanisms to identify programs or websites as possessing some level of trust. Examples of such features include: an app being allowed to run because it is signed by a valid code signing certificate; an OS prompt alerting the user that an app came from an untrusted source; or getting an indication that you are about to connect to an untrusted site. The method adversaries use will depend on the specific mechanism they seek to subvert. ,https://attack.mitre.org/techniques/T1632,30 March 2022,08 April 2022,1.0,,Defense Evasion,"On Android, the user can use the device settings menu to view trusted CA certificates and look for unexpected or unknown certificates. A mobile security product could similarly examine the trusted CA certificate store for anomalies. Users can use the device settings menu to view which applications on the device are allowed to install unknown applications. 

On iOS, the user can use the device settings menu to view installed Configuration Profiles and look for unexpected or unknown profiles. A Mobile Device Management (MDM) system could use the iOS MDM APIs to examine the list of installed Configuration Profiles for anomalies.","Android, iOS",Post-Adversary Device Access,STA-7,",(Citation: Symantec-iOSProfile2),(Citation: Android-TrustedCA)"
T1474,Supply Chain Compromise,"Adversaries may manipulate products or product delivery mechanisms prior to receipt by a final consumer for the purpose of data or system compromise.

Supply chain compromise can take place at any stage of the supply chain including:

* Manipulation of development tools
* Manipulation of a development environment
* Manipulation of source code repositories (public or private)
* Manipulation of source code in open-source dependencies
* Manipulation of software update/distribution mechanisms
* Compromised/infected system images
* Replacement of legitimate software with modified versions
* Sales of modified/counterfeit products to legitimate distributors
* Shipment interdiction

While supply chain compromise can impact any component of hardware or software, attackers looking to gain execution have often focused on malicious additions to legitimate software in software distribution or update channels. Targeting may be specific to a desired victim set or malicious software may be distributed to a broad set of consumers but only move on to additional tactics on specific victims.  Popular open source projects that are used as dependencies in many applications may also be targeted as a means to add malicious code to users of the dependency, specifically with the widespread usage of third-party advertising libraries.(Citation: Grace-Advertisement)(Citation: NowSecure-RemoteCode)",https://attack.mitre.org/techniques/T1474,17 October 2018,28 March 2022,2.0,,Initial Access,Usage of insecure or malicious third-party libraries could be detected by application vetting services. Malicious software development tools could be detected by enterprises that deploy endpoint protection software on computers that are used to develop mobile apps. Application vetting could detect the usage of insecure or malicious third-party libraries.,"Android, iOS",Post-Adversary Device Access,APP-6,","
T1628.001,Suppress Application Icon,"A malicious application could suppress its icon from being displayed to the user in the application launcher. This hides the fact that it is installed, and can make it more difficult for the user to uninstall the application. Hiding the application's icon programmatically does not require any special permissions. 

This behavior has been seen in the BankBot/Spy Banker family of malware.(Citation: android-trojan-steals-paypal-2fa)(Citation: sunny-stolen-credentials)(Citation: bankbot-spybanker) 

Beginning in Android 10, changes were introduced to inhibit malicious applications’ ability to hide their icon. If an app is a system app, requests no permissions, or does not have a launcher activity, the application’s icon will be fully hidden. Further, if the device is fully managed or the application is in a work profile, the icon will be fully hidden. Otherwise, a synthesized activity is shown, which is a launcher icon that represents the app’s details page in the system settings. If the user clicks the synthesized activity in the launcher, they are taken to the application’s details page in the system settings.(Citation: Android 10 Limitations to Hiding App Icons)(Citation: LauncherApps getActivityList)",https://attack.mitre.org/techniques/T1628/001,30 March 2022,20 May 2022,1.0,"Emily Ratliff, IBM",Defense Evasion,"The user can examine the list of all installed applications, including those with a suppressed icon, in the device settings. If the user is redirected to the device settings when tapping an application’s icon, they should inspect the application to ensure it is genuine. Application vetting services could potentially detect the usage of APIs intended for suppressing the application’s icon.",Android,Post-Adversary Device Access,,"(Citation: ThreatFabric Ginp),(Citation: Lookout Uyghur Campaign),(Citation: FortiGuard-FlexiSpy),(Citation: Threat Fabric Cerberus),(Citation: FlexiSpy-Features),(Citation: securelist rotexy 2018),(Citation: Zscaler TikTok Spyware),(Citation: Lookout Desert Scorpion),(Citation: WeLiveSecurity AdDisplayAshas),(Citation: CheckPoint SimBad 2019),(Citation: Bitdefender - Triout 2018),(Citation: ESET-Twitoor),(Citation: SecureList BusyGasper),(Citation: CheckPoint Agent Smith),(Citation: Bitdefender Mandrake),(Citation: Cybereason FakeSpy),(Citation: Group IB Gustuff Mar 2019),(Citation: LauncherApps getActivityList),(Citation: Android 10 Limitations to Hiding App Icons)"
T1521.001,Symmetric Cryptography,"Adversaries may employ a known symmetric encryption algorithm to conceal command and control traffic, rather than relying on any inherent protections provided by a communication protocol. Symmetric encryption algorithms use the same key for plaintext encryption and ciphertext decryption. Common symmetric encryption algorithms include AES, Blowfish, and RC4.",https://attack.mitre.org/techniques/T1521/001,05 April 2022,05 April 2022,1.0,,Command and Control,"Since data encryption is a common practice in many legitimate applications and uses standard programming language-specific APIs, encrypting data for command and control communication is regarded as undetectable to the user.","Android, iOS",Post-Adversary Device Access,,"(Citation: Cybereason EventBot),(Citation: BlackBerry Bahamut),(Citation: securelist rotexy 2018),"
T1633.001,System Checks,"Adversaries may employ various system checks to detect and avoid virtualization and analysis environments. This may include changing behavior after checking for the presence of artifacts indicative of a virtual environment or sandbox. If the adversary detects a virtual environment, they may alter their malware’s behavior to disengage from the victim or conceal the core functions of the implant. They may also search for virtualization artifacts before dropping secondary or additional payloads. 

Checks could include generic system properties such as host/domain name and samples of network traffic. Adversaries may also check the network adapters addresses, CPU core count, and available memory/drive size. 

Hardware checks, such as the presence of motion sensors, could also be used to gather evidence that can be indicative a virtual environment. Adversaries may also query for specific readings from these devices. ",https://attack.mitre.org/techniques/T1633/001,30 March 2022,21 April 2022,1.0,,Defense Evasion,"Application vetting services could look for applications attempting to get `android.os.SystemProperties` or `getprop` with the runtime `exec()` commands. This could indicate some level of sandbox evasion, as Google recommends against using system properties within applications.","Android, iOS",Post-Adversary Device Access,,"(Citation: ThreatFabric Ginp),(Citation: WhiteOps TERRACOTTA),(Citation: Threat Fabric Cerberus),(Citation: Trend Micro Anubis),(Citation: Cybereason FakeSpy),(Citation: Talos-WolfRAT),(Citation: securelist rotexy 2018),(Citation: Palo Alto HenBox),(Citation: SecurityIntelligence TrickMo),(Citation: WeLiveSecurity AdDisplayAshas),(Citation: BlackBerry Bahamut),(Citation: Bitdefender Mandrake),(Citation: Lookout-Dendroid),"
T1426,System Information Discovery,"Adversaries may attempt to get detailed information about a device’s operating system and hardware, including versions, patches, and architecture. Adversaries may use the information from [System Information Discovery](https://attack.mitre.org/techniques/T1426) during automated discovery to shape follow-on behaviors, including whether or not to fully infects the target and/or attempts specific actions. 

 

On Android, much of this information is programmatically accessible to applications through the `android.os.Build` class. (Citation: Android-Build) iOS is much more restrictive with what information is visible to applications. Typically, applications will only be able to query the device model and which version of iOS it is running. ",https://attack.mitre.org/techniques/T1426,25 October 2017,11 April 2022,1.2,,Discovery,"System information discovery can be difficult to detect, and therefore enterprises may be better served focusing on detection at other stages of adversarial behavior.","Android, iOS",Post-Adversary Device Access,APP-12,"(Citation: Threat Fabric Cerberus),(Citation: securelist rotexy 2018),(Citation: CYBERWARCON CHEMISTGAMES),(Citation: Talos GPlayed),(Citation: Talos Gustuff Apr 2019),(Citation: Xiao-KeyRaider),(Citation: FireEye-RuMMS),(Citation: Cofense Anubis),(Citation: TrendMicro-XLoader-FakeSpy),(Citation: Lookout ViperRAT),(Citation: Bitdefender Mandrake),(Citation: Cybereason FakeSpy),(Citation: Zscaler TikTok Spyware),(Citation: Securelist Asacub),(Citation: Lookout Uyghur Campaign),(Citation: SecureList - ViceLeaker 2019),(Citation: Kaspersky Riltok June 2019),(Citation: Google Project Zero Insomnia),(Citation: WeLiveSecurity AdDisplayAshas),(Citation: CheckPoint Cerberus),(Citation: Threat Fabric Exobot),(Citation: Kaspersky-WUC),(Citation: Cybereason EventBot),(Citation: Lookout-Monokle),(Citation: Wandera-RedDrop),(Citation: Lookout eSurv),(Citation: TrendMicro Coronavirus Updates),(Citation: Lookout Desert Scorpion),(Citation: SecurityIntelligence TrickMo),(Citation: Lookout-Pegasus),(Citation: TrendMicro-Anserver2),(Citation: Lookout FrozenCell),(Citation: Symantec GoldenCup),(Citation: Palo Alto HenBox),(Citation: SecureList DVMap June 2017),(Citation: Lookout Dark Caracal Jan 2018),(Citation: BlackBerry Bahamut),(Citation: Trend Micro Bouncing Golf 2019),"
T1422,System Network Configuration Discovery,"Adversaries may look for details about the network configuration and settings, such as IP and/or MAC addresses, of operating systems they access or through information discovery of remote systems. 

 

On Android, details of onboard network interfaces are accessible to apps through the `java.net.NetworkInterface` class.(Citation: NetworkInterface) Previously, the Android `TelephonyManager` class could be used to gather telephony-related device identifiers, information such as the IMSI, IMEI, and phone number. However, starting with Android 10, only preloaded, carrier, the default SMS, or device and profile owner applications can access the telephony-related device identifiers.(Citation: TelephonyManager) 

 

On iOS, gathering network configuration information is not possible without root access. 

 

Adversaries may use the information from [System Network Configuration Discovery](https://attack.mitre.org/techniques/T1422) during automated discovery to shape follow-on behaviors, including determining certain access within the target network and what actions to do next. ",https://attack.mitre.org/techniques/T1422,25 October 2017,30 March 2022,2.2,,Discovery,Application vetting services could look for usage of the `READ_PRIVILEGED_PHONE_STATE` Android permission. This could indicate that non-system apps are attempting to access information that they do not have access to.,"Android, iOS",Post-Adversary Device Access,,"(Citation: Talos-WolfRAT),(Citation: securelist rotexy 2018),(Citation: Talos Gustuff Apr 2019),(Citation: Talos GPlayed),(Citation: FireEye-RuMMS),(Citation: TrendMicro-XLoader-FakeSpy),(Citation: PaloAlto-SpyDealer),(Citation: Lookout ViperRAT),(Citation: Lookout-EnterpriseApps),(Citation: Cybereason FakeSpy),(Citation: Securelist Asacub),(Citation: Lookout Uyghur Campaign),(Citation: WhiteOps TERRACOTTA),(Citation: PaloAlto-DualToy),(Citation: Kaspersky Riltok June 2019),(Citation: Google Project Zero Insomnia),(Citation: Threat Fabric Exobot),(Citation: Lookout-Monokle),(Citation: Cybereason EventBot),(Citation: Wandera-RedDrop),(Citation: TrendMicro Coronavirus Updates),(Citation: SWB Exodus March 2019),(Citation: SecurityIntelligence TrickMo),(Citation: Lookout-PegasusAndroid),(Citation: Google Bread),(Citation: Lookout-StealthMango),(Citation: TrendMicro-Anserver2),(Citation: Lookout FrozenCell),(Citation: Symantec GoldenCup),(Citation: TelephonyManager)"
T1421,System Network Connections Discovery,"Adversaries may attempt to get a listing of network connections to or from the compromised device they are currently accessing or from remote systems by querying for information over the network. 

 

This is typically accomplished by utilizing device APIs to collect information about nearby networks, such as Wi-Fi, Bluetooth, and cellular tower connections. On Android, this can be done by querying the respective APIs: 

 

* `WifiInfo` for information about the current Wi-Fi connection, as well as nearby Wi-Fi networks. Querying the `WiFiInfo` API requires the application to hold the `ACCESS_FINE_LOCATION` permission. 

* `BluetoothAdapter` for information about Bluetooth devices, which also requires the application to hold several permissions granted by the user at runtime. 

* For Android versions prior to Q, applications can use the `TelephonyManager.getNeighboringCellInfo()` method. For Q and later, applications can use the `TelephonyManager.getAllCellInfo()` method. Both methods require the application hold the `ACCESS_FINE_LOCATION` permission.",https://attack.mitre.org/techniques/T1421,25 October 2017,31 March 2022,2.1,,Discovery,"System Network Connections Discovery can be difficult to detect, and therefore enterprises may be better served focusing on detection at other stages of adversarial behavior.",Android,Post-Adversary Device Access,,"(Citation: FlexiSpy-Features),(Citation: SWB Exodus March 2019),(Citation: Lookout Dark Caracal Jan 2018),(Citation: Lookout-Monokle),(Citation: Lookout ViperRAT),(Citation: Cybereason FakeSpy),(Citation: Lookout-Pegasus),"
T1625.001,System Runtime API Hijacking,"Adversaries may execute their own malicious payloads by hijacking the way an operating system run applications. Hijacking execution flow can be for the purposes of persistence since this hijacked execution may reoccur at later points in time. 


On Android, adversaries may overwrite the standard OS API library with a malicious alternative to hook into core functions to achieve persistence. By doing this, the adversary’s code will be executed every time the overwritten API function is called by an app on the infected device.",https://attack.mitre.org/techniques/T1625/001,30 March 2022,05 April 2022,1.0,,Persistence,Mobile threat defense agents could detect unauthorized operating system modifications by using attestation. ,Android,Post-Adversary Device Access,APP-27,"(Citation: Google Security Zen),(Citation: FortiGuard-FlexiSpy),(Citation: SecureList DVMap June 2017),(Citation: Android-VerifiedBoot)"
T1641.001,Transmitted Data Manipulation,"Adversaries may alter data en route to storage or other systems in order to manipulate external outcomes or hide activity. By manipulating transmitted data, adversaries may attempt to affect a business process, organizational understanding, or decision making.

Manipulation may be possible over a network connection or between system processes where there is an opportunity to deploy a tool that will intercept and change information. The type of modification and the impact it will have depends on the target transmission mechanism as well as the goals and objectives of the adversary. For complex systems, an adversary would likely need special expertise and possibly access to specialized software related to the system, typically gained through a prolonged information gathering campaign, in order to have the desired impact.

One method to achieve [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1641/001) is by modifying the contents of the device clipboard. Malicious applications may monitor clipboard activity through the `ClipboardManager.OnPrimaryClipChangedListener` interface on Android to determine when clipboard contents have changed. Listening to clipboard activity, reading clipboard contents, and modifying clipboard contents requires no explicit application permissions and can be performed by applications running in the background. However, this behavior has changed with the release of Android 10.

Adversaries may use [Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1641/001) to replace text prior to being pasted. For example, replacing a copied Bitcoin wallet address with a wallet address that is under adversarial control.

[Transmitted Data Manipulation](https://attack.mitre.org/techniques/T1641/001) was seen within the Android/Clipper.C trojan. This sample was detected by ESET in an application distributed through the Google Play Store targeting cryptocurrency wallet numbers.(Citation: ESET Clipboard Modification February 2019)",https://attack.mitre.org/techniques/T1641/001,06 April 2022,21 April 2022,1.0,,Impact,Applications could be vetted for their use of the clipboard manager APIs with extra scrutiny given to application that make use of them.,Android,Post-Adversary Device Access,,",(Citation: Android 10 Privacy Changes)"
T1635.001,URI Hijacking,"Adversaries may register Uniform Resource Identifiers (URIs) to intercept sensitive data. 

Applications regularly register URIs with the operating system to act as a response handler for various actions, such as logging into an app using an external account via single sign-on. This allows redirections to that specific URI to be intercepted by the application. If an adversary were to register for a URI that was already in use by a genuine application, the adversary may be able to intercept data intended for the genuine application or perform a phishing attack against the genuine application. Intercepted data may include OAuth authorization codes or tokens that could be used by the adversary to gain access to protected resources.(Citation: Trend Micro iOS URL Hijacking)(Citation: IETF-PKCE) ",https://attack.mitre.org/techniques/T1635/001,01 April 2022,06 April 2022,1.0,"Leo Zhang, Trend Micro; Steven Du, Trend Micro",Credential Access,"On Android, users may be presented with a popup to select the appropriate application to open the URI in. If the user sees an application they do not recognize, they can remove it. When vetting applications for potential security weaknesses, the vetting process could look for insecure use of Intents. Developers should be encouraged to use techniques to ensure that the intent can only be sent to an appropriate destination (e.g., use explicit rather than implicit intents, permission checking, checking of the destination app's signing certificate, or utilizing the App Links feature). For mobile applications using OAuth, encourage use of best practice. (Citation: IETF-OAuthNativeApps)(Citation: Android-AppLinks)","Android, iOS",Post-Adversary Device Access,,",(Citation: Trend Micro iOS URL Hijacking),(Citation: Android App Links),(Citation: IETF-PKCE),(Citation: iOS Universal Links)"
T1630.001,Uninstall Malicious Application,"Adversaries may include functionality in malware that uninstalls the malicious application from the device. This can be achieved by: 
 
* Abusing device owner permissions to perform silent uninstallation using device owner API calls. 
* Abusing root permissions to delete files from the filesystem. 
* Abusing the accessibility service. This requires sending an intent to the system to request uninstallation, and then abusing the accessibility service to click the proper places on the screen to confirm uninstallation.",https://attack.mitre.org/techniques/T1630/001,30 March 2022,21 April 2022,1.0,,Defense Evasion,Users can see a list of applications that can use accessibility services in the device settings. Application vetting services could look for use of the accessibility service or features that typically require root access.,Android,Post-Adversary Device Access,APP-43,"(Citation: SecurityIntelligence TrickMo),(Citation: Threat Fabric Cerberus),"
T1623.001,Unix Shell,"Adversaries may abuse Unix shell commands and scripts for execution. Unix shells are the underlying command prompts on Android and iOS devices. Unix shells can control every aspect of a system, with certain commands requiring elevated privileges that are only accessible if the device has been rooted or jailbroken. 

Unix shells also support scripts that enable sequential execution of commands as well as other typical programming operations such as conditionals and loops. Common uses of shell scripts include long or repetitive tasks, or the need to run the same set of commands on multiple systems. 

Adversaries may abuse Unix shells to execute various commands or payloads. Interactive shells may be accessed through command and control channels or during lateral movement such as with SSH. Adversaries may also leverage shell scripts to deliver and execute multiple commands on victims or as part of payloads used for persistence. 

If the device has been rooted or jailbroken, adversaries may locate and invoke a superuser binary to elevate their privileges and interact with the system as the root user. This dangerous level of permissions allows the adversary to run special commands and modify protected system files.  ",https://attack.mitre.org/techniques/T1623/001,30 March 2022,05 April 2022,1.0,,Execution,"Command-line activities can potentially be detected through Mobile Threat Defense integrations with lower-level OS APIs. This could grant the MTD agents access to running processes and their parameters, potentially detecting unwanted or malicious shells.

Application vetting services could detect the invocations of methods that could be used to execute shell commands.(Citation: Samsung Knox Mobile Threat Defense)","Android, iOS",Post-Adversary Device Access,,"(Citation: Lookout Uyghur Campaign),(Citation: CYBERWARCON CHEMISTGAMES),(Citation: Palo Alto HenBox),(Citation: SecureList BusyGasper),(Citation: Zscaler TikTok Spyware),"
T1628.002,User Evasion,"Adversaries may attempt to avoid detection by hiding malicious behavior from the user. By doing this, an adversary’s modifications would most likely remain installed on the device for longer, allowing the adversary to continue to operate on that device. 

While there are many ways this can be accomplished, one method is by using the device’s sensors. By utilizing the various motion sensors on a device, such as accelerometer or gyroscope, an application could detect that the device is being interacted with. That way, the application could continue to run while the device is not in use but cease operating while the user is using the device, hiding anything that would indicate malicious activity was ongoing. Accessing the sensors in this way does not require any permissions from the user, so it would be completely transparent.",https://attack.mitre.org/techniques/T1628/002,11 April 2022,11 April 2022,1.0,,Defense Evasion,"Mobile security products may be able to detect some forms of user evasion. Otherwise, the act of hiding malicious activity could be difficult to detect, and therefore enterprises may be better served focusing on detection at other stages of adversarial behavior.",Android,Post-Adversary Device Access,,"(Citation: SecureList BusyGasper),"
T1512,Video Capture,"An adversary can leverage a device’s cameras to gather information by capturing video recordings. Images may also be captured, potentially in specified intervals, in lieu of video files.  

 

Malware or scripts may interact with the device cameras through an available API provided by the operating system. Video or image files may be written to disk and exfiltrated later. This technique differs from [Screen Capture](https://attack.mitre.org/techniques/T1513) due to use of the device’s cameras for video recording rather than capturing the victim’s screen. 

 

In Android, an application must hold the `android.permission.CAMERA` permission to access the cameras. In iOS, applications must include the `NSCameraUsageDescription` key in the `Info.plist` file. In both cases, the user must grant permission to the requesting application to use the camera. If the device has been rooted or jailbroken, an adversary may be able to access the camera without knowledge of the user.  ",https://attack.mitre.org/techniques/T1512,09 August 2019,08 April 2022,2.0,,Collection,"The user can view which applications have permission to use the camera through the device settings screen, where the user can then choose to revoke the permissions. During the vetting process, applications using the Android permission `android.permission.CAMERA`, or the iOS `NSCameraUsageDescription` plist entry could be given closer scrutiny. ","Android, iOS",Post-Adversary Device Access,APP-19,"(Citation: Talos-WolfRAT),(Citation: TrendMicro-RCSAndroid),(Citation: SecureList BusyGasper),(Citation: PaloAlto-SpyDealer),(Citation: Lookout ViperRAT),(Citation: Zscaler TikTok Spyware),(Citation: SecureList - ViceLeaker 2019),(Citation: Lookout Uyghur Campaign),(Citation: Kaspersky-Skygofree),(Citation: Zscaler-SuperMarioRun),(Citation: Lookout-Monokle),(Citation: Lookout-Dendroid),(Citation: CyberMerchants-FlexiSpy),(Citation: TrendMicro Coronavirus Updates),(Citation: SWB Exodus March 2019),(Citation: Lookout Desert Scorpion),(Citation: Lookout-PegasusAndroid),(Citation: Lookout-StealthMango),(Citation: Symantec GoldenCup),(Citation: Palo Alto HenBox),(Citation: Lookout Dark Caracal Jan 2018),(Citation: BlackBerry Bahamut),(Citation: Trend Micro Bouncing Golf 2019),(Citation: Android Capture Sensor 2019)"
T1633,Virtualization/Sandbox Evasion,"Adversaries may employ various means to detect and avoid virtualization and analysis environments. This may include changing behaviors after checking for the presence of artifacts indicative of a virtual machine environment (VME) or sandbox. If the adversary detects a VME, they may alter their malware’s behavior to disengage from the victim or conceal the core functions of the payload. They may also search for VME artifacts before dropping further payloads. Adversaries may use the information learned from [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1633) during automated discovery to shape follow-on behaviors. 

Adversaries may use several methods to accomplish [Virtualization/Sandbox Evasion](https://attack.mitre.org/techniques/T1633) such as checking for system artifacts associated with analysis or virtualization. Adversaries may also check for legitimate user activity to help determine if it is in an analysis environment. ",https://attack.mitre.org/techniques/T1633,30 March 2022,08 April 2022,1.0,,Defense Evasion,"Application vetting services could look for applications attempting to get `android.os.SystemProperties` or `getprop` with the runtime `exec()` commands. This could indicate some level of sandbox evasion, as Google recommends against using system properties within applications.","Android, iOS",Post-Adversary Device Access,,","
T1437.001,Web Protocols,"Adversaries may communicate using application layer protocols associated with web protocols traffic to avoid detection/network filtering by blending in with existing traffic. Commands to remote mobile devices, and often the results of those commands, will be embedded within the protocol traffic between the mobile client and server. 

Web protocols such as HTTP and HTTPS are used for web traffic as well as well as notification services native to mobile messaging services such as Google Cloud Messaging (GCM) and newly, Firebase Cloud Messaging (FCM), (GCM/FCM: two-way communication) and Apple Push Notification Service (APNS; one-way server-to-device).  Such notification services leverage HTTP/S via the respective API and are commonly abused on Android and iOS respectively in order blend in with routine device traffic making it difficult for enterprises to inspect. ",https://attack.mitre.org/techniques/T1437/001,01 April 2022,06 April 2022,1.0,,Command and Control,Abuse of standard application protocols can be difficult to detect as many legitimate mobile applications leverage such protocols for language-specific APIs. Enterprises may be better served focusing on detection at other stages of adversarial behavior. ,"Android, iOS",Post-Adversary Device Access,APP-29,"(Citation: securelist rotexy 2018),(Citation: CYBERWARCON CHEMISTGAMES),(Citation: Talos GPlayed),(Citation: Talos Gustuff Apr 2019),(Citation: FireEye-RuMMS),(Citation: ESET DEFENSOR ID),(Citation: Cybereason FakeSpy),(Citation: Securelist Asacub),(Citation: Lookout Uyghur Campaign),(Citation: SecureList - ViceLeaker 2019),(Citation: Kaspersky-Skygofree),(Citation: Kaspersky Riltok June 2019),(Citation: Volexity Insomnia),(Citation: WeLiveSecurity AdDisplayAshas),(Citation: CheckPoint Cerberus),(Citation: Threat Fabric Exobot),(Citation: Cybereason EventBot),(Citation: Kaspersky-WUC),(Citation: Wandera-RedDrop),(Citation: Kaspersky-MobileMalware),(Citation: TrendMicro Coronavirus Updates),(Citation: SWB Exodus March 2019),(Citation: SecurityIntelligence TrickMo),(Citation: Bitdefender - Triout 2018),(Citation: Google Bread),(Citation: Symantec GoldenCup),(Citation: Lookout Dark Caracal Jan 2018),(Citation: Sophos Red Alert 2.0),"
T1481,Web Service,"Adversaries may use an existing, legitimate external Web service as a means for relaying data to/from a compromised system. Popular websites and social media, acting as a mechanism for C2, may give a significant amount of cover. This is due to the likelihood that hosts within a network are already communicating with them prior to a compromise. Using common services, such as those offered by Google or Twitter, makes it easier for adversaries to hide in expected noise. Web service providers commonly use SSL/TLS encryption, giving adversaries an added level of protection. 

 

Use of Web services may also protect back-end C2 infrastructure from discovery through malware binary analysis, or enable operational resiliency (since this infrastructure may be dynamically changed). 

 ",https://attack.mitre.org/techniques/T1481,01 February 2019,06 April 2022,1.1,,Command and Control,"Application vetting services may provide a list of connections made or received by an application, or a list of domains contacted by the application.","Android, iOS",Post-Adversary Device Access,,","